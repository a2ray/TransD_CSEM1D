<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T21U3">Er</span>,<span class="var type1" id="S3T21U4">Eb</span>,<span class="var type1" id="S4T21U5">Hr</span>,<span class="var type1" id="S5T21U6">Hb</span>,<span class="var type1" id="S6T21U7">Ez</span>,<span class="var type1" id="S7T21U8">Hz</span>] = get_CSEM1D_FD_FHT_aniso_hed(<span class="var type1" id="S8T18U11">freqs</span>,<span class="var type1" id="S9T2U12">rRx</span>,<span class="var type1" id="S10T2U13">zRx</span>,<span class="var type1" id="S11T1U14">zTx</span>,<span class="var type1" id="S12T2U15">z</span>,<span class="var type1" id="S13T33U16">sig</span>,<span class="var type1" id="S14T52U17">filterName</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line">                                       <span class="var type1" id="S15T1U18">lUseLaggedConv</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% Returns 1D CSEM fields due to an HED</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% ***Bessel function integrals are evaluated using the digital filter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%    method (aka the Fast Hankel Transform) and lagged convolution***</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% In this code, I've only tested out the lagged convolution method which</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% requires that all receivers be at the same depth</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">% Returns the inline horizontal electric field from a frequency domain</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">% horizontal electric dipole in an arbitrary N-layered medium. </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">% Inputs:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">% freqs  - Vector of frequencies (Hz)   </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">% rRx    - Vector of ranges from transmitter to receivers (m, positive).</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">% zRx    - Vector of depths of receivers (m), relative to where 0 is defined</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%          in the model layer top-depths in z.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">% zTx    - Depth of transmitter (m)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">% z      - Layer top-depths (m). First value is ignored. Also 0 is anywhere </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%          you want it to be, this code makes no model assumptions other </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%          than that the values in z need to be increasing.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">% sig    - Conductivity of each layer (s/m).  z,sig need to include all</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%          layers of the model. **This code makes no assumptions about air </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">%          or sea layers.  </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">% filterName     - Name of filter to use</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%                 ('kk51Hankel.mat', 'kk101Hankel.mat', 'kk201Hankel.mat', , 'wa801Hankel.mat')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">% lUseLaggedConv - Optional. Set to true if you want to use the lagged</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%                  convolution + spline interpolation speed up when computing</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">%                  response for many receivers.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">% Note that the code currently requires both the transmitter and receiver</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">% to be in the same layer. Also, if the transmitter and/or receiver are</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">% positioned on a boundary, they are assumed to reside in the upper layer.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">% For example if they are on the seafloor, then the upper sea layer is</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">% used. For land EM modeling, you should nudge the transmitter and</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">% receiver a few cm into the earth (ie, zTx = 0.1 m), otherwise you'll be</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">% telling the code to inject a 1 amp source current into the air, which i'm</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">% told is quite difficult to do!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">% Outputs: All components of the CSEM field due to an HED, </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">% in cylindrical co-ordinates, as described in Lars Loseth's PhD thesis (2007) </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="comment">% Written by:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="comment">% Kerry Key and Anandaroop Ray</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="comment">% Scripps Institution of Oceanography</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="comment">% History:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="comment">% May 2011  - implemented</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">%--------------------------------------------------------------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">coder.extrinsic (<span class="string">'beep'</span>,<span class="string">'display'</span>,<span class="string">'disp'</span>,<span class="string">'spline'</span>,<span class="string">'ppval'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">% Check for optional lSpline input:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="comment">%     if ~exist('lUseLaggedConv','var')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">%         lUseLaggedConv = false;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T5:U15"><span class="var type1" id="S15T1U33">lUseLaggedConv</span> == <span class="mxinfo" id="T1:U17">1</span></span> &amp;&amp; <span class="mxinfo" id="T5:U18"><span class="mxinfo" id="T1:U19">length(<span class="var type1" id="S9T2U38">rRx</span>)</span> == <span class="mxinfo" id="T1:U21">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">        <span class="mxinfo" id="T1:U22"><span class="var type1" id="S15T1U42">lUseLaggedConv</span> = <span class="mxinfo" id="T1:U24">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T5:U25"><span class="mxinfo" id="T1:U26">length(<span class="mxinfo" id="T3:U27">unique(<span class="var type1" id="S10T2U52">zRx</span>)</span>)</span> &gt; <span class="mxinfo" id="T1:U29">1</span></span> &amp;&amp; <span class="mxinfo" id="T5:U30"><span class="var type1" id="S15T1U55">lUseLaggedConv</span>==<span class="mxinfo" id="T1:U32">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">        <span class="mxinfo" id="T51:U33"><span class="extrinsicFcn" id="F293N2:B59">beep</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">        <span class="mxinfo" id="T1:U34"><span class="var type1" id="S15T1U62">lUseLaggedConv</span> = <span class="mxinfo" id="T1:U36">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">        <span class="extrinsicFcn" id="F294N4:B66">display</span>(<span class="string">'Warning, not using lagged convolution since the receivers are not all at the same depth.'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">    <span class="keyword">end</span>    </span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"><span class="comment">% Load the digital filter weights:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">    <span class="mxinfo" id="T28:U37"><span class="mxinfo" id="T28:U38"><span class="var type1" id="S21T27U71">Filter</span>.J0</span> = <span class="mxinfo" id="T28:U40"><span class="mxinfo" id="T29:U41">[   <span class="mxinfo" id="T1:U42">1.5020099e-03</span>  <span class="mxinfo" id="T1:U43">-<span class="mxinfo" id="T1:U44">1.0381698e-02</span></span>   <span class="mxinfo" id="T1:U45">3.6840860e-02</span>  <span class="mxinfo" id="T1:U46">-<span class="mxinfo" id="T1:U47">8.9903380e-02</span></span>   <span class="mxinfo" id="T1:U48">1.7082287e-01</span>  <span class="mxinfo" id="T1:U49">-<span class="mxinfo" id="T1:U50">2.7115750e-01</span></span>   <span class="mxinfo" id="T1:U51">3.7649328e-01</span>  <span class="mxinfo" id="T1:U52">-<span class="mxinfo" id="T1:U53">4.7220779e-01</span></span>   <span class="mxinfo" id="T1:U54">5.4778211e-01</span>  <span class="mxinfo" id="T1:U55">-<span class="mxinfo" id="T1:U56">5.9823517e-01</span></span>   <span class="mxinfo" id="T1:U57">6.2345792e-01</span>  <span class="mxinfo" id="T1:U58">-<span class="mxinfo" id="T1:U59">6.2650437e-01</span></span>   <span class="mxinfo" id="T1:U60">6.1197225e-01</span>  <span class="mxinfo" id="T1:U61">-<span class="mxinfo" id="T1:U62">5.8470174e-01</span></span>   <span class="mxinfo" id="T1:U63">5.4911056e-01</span>  <span class="mxinfo" id="T1:U64">-<span class="mxinfo" id="T1:U65">5.0878862e-01</span></span>   <span class="mxinfo" id="T1:U66">4.6652106e-01</span>  <span class="mxinfo" id="T1:U67">-<span class="mxinfo" id="T1:U68">4.2426479e-01</span></span>   <span class="mxinfo" id="T1:U69">3.8339539e-01</span>  <span class="mxinfo" id="T1:U70">-<span class="mxinfo" id="T1:U71">3.4472345e-01</span></span>   <span class="mxinfo" id="T1:U72">3.0876891e-01</span>  <span class="mxinfo" id="T1:U73">-<span class="mxinfo" id="T1:U74">2.7570439e-01</span></span>   <span class="mxinfo" id="T1:U75">2.4562331e-01</span>  <span class="mxinfo" id="T1:U76">-<span class="mxinfo" id="T1:U77">2.1839207e-01</span></span>   <span class="mxinfo" id="T1:U78">1.9393194e-01</span>  <span class="mxinfo" id="T1:U79">-<span class="mxinfo" id="T1:U80">1.7198163e-01</span></span>   <span class="mxinfo" id="T1:U81">1.5242270e-01</span>  <span class="mxinfo" id="T1:U82">-<span class="mxinfo" id="T1:U83">1.3494946e-01</span></span>   <span class="mxinfo" id="T1:U84">1.1946763e-01</span>  <span class="mxinfo" id="T1:U85">-<span class="mxinfo" id="T1:U86">1.0565871e-01</span></span>   <span class="mxinfo" id="T1:U87">9.3482356e-02</span>  <span class="mxinfo" id="T1:U88">-<span class="mxinfo" id="T1:U89">8.2612525e-02</span></span>   <span class="mxinfo" id="T1:U90">7.3077764e-02</span>  <span class="mxinfo" id="T1:U91">-<span class="mxinfo" id="T1:U92">6.4536481e-02</span></span>   <span class="mxinfo" id="T1:U93">5.7096311e-02</span>  <span class="mxinfo" id="T1:U94">-<span class="mxinfo" id="T1:U95">5.0384860e-02</span></span>   <span class="mxinfo" id="T1:U96">4.4599557e-02</span>  <span class="mxinfo" id="T1:U97">-<span class="mxinfo" id="T1:U98">3.9316995e-02</span></span>   <span class="mxinfo" id="T1:U99">3.4838545e-02</span>  <span class="mxinfo" id="T1:U100">-<span class="mxinfo" id="T1:U101">3.0664946e-02</span></span>   <span class="mxinfo" id="T1:U102">2.7221072e-02</span>  <span class="mxinfo" id="T1:U103">-<span class="mxinfo" id="T1:U104">2.3901586e-02</span></span>   <span class="mxinfo" id="T1:U105">2.1281567e-02</span>  <span class="mxinfo" id="T1:U106">-<span class="mxinfo" id="T1:U107">1.8612485e-02</span></span>   <span class="mxinfo" id="T1:U108">1.6655386e-02</span>  <span class="mxinfo" id="T1:U109">-<span class="mxinfo" id="T1:U110">1.4472420e-02</span></span>   <span class="mxinfo" id="T1:U111">1.3057748e-02</span>  <span class="mxinfo" id="T1:U112">-<span class="mxinfo" id="T1:U113">1.1226286e-02</span></span>   <span class="mxinfo" id="T1:U114">1.0266819e-02</span>  <span class="mxinfo" id="T1:U115">-<span class="mxinfo" id="T1:U116">8.6738022e-03</span></span>   <span class="mxinfo" id="T1:U117">8.1103369e-03</span>  <span class="mxinfo" id="T1:U118">-<span class="mxinfo" id="T1:U119">6.6573628e-03</span></span>   <span class="mxinfo" id="T1:U120">6.4551190e-03</span>  <span class="mxinfo" id="T1:U121">-<span class="mxinfo" id="T1:U122">5.0524015e-03</span></span>   <span class="mxinfo" id="T1:U123">5.1989014e-03</span>  <span class="mxinfo" id="T1:U124">-<span class="mxinfo" id="T1:U125">3.7597430e-03</span></span>   <span class="mxinfo" id="T1:U126">4.2640545e-03</span>  <span class="mxinfo" id="T1:U127">-<span class="mxinfo" id="T1:U128">2.6994966e-03</span></span>   <span class="mxinfo" id="T1:U129">3.5928001e-03</span>  <span class="mxinfo" id="T1:U130">-<span class="mxinfo" id="T1:U131">1.8061291e-03</span></span>   <span class="mxinfo" id="T1:U132">3.1436471e-03</span>  <span class="mxinfo" id="T1:U133">-<span class="mxinfo" id="T1:U134">1.0244200e-03</span></span>   <span class="mxinfo" id="T1:U135">2.8888298e-03</span>  <span class="mxinfo" id="T1:U136">-<span class="mxinfo" id="T1:U137">3.0605071e-04</span></span>   <span class="mxinfo" id="T1:U138">2.8125907e-03</span>   <span class="mxinfo" id="T1:U139">3.9337862e-04</span>   <span class="mxinfo" id="T1:U140">2.9102041e-03</span>   <span class="mxinfo" id="T1:U141">1.1170885e-03</span>   <span class="mxinfo" id="T1:U142">3.1876763e-03</span>   <span class="mxinfo" id="T1:U143">1.9097806e-03</span>   <span class="mxinfo" id="T1:U144">3.6621020e-03</span>   <span class="mxinfo" id="T1:U145">2.8203784e-03</span>   <span class="mxinfo" id="T1:U146">4.3626886e-03</span>   <span class="mxinfo" id="T1:U147">3.9050025e-03</span>   <span class="mxinfo" id="T1:U148">5.3324923e-03</span>   <span class="mxinfo" id="T1:U149">5.2303399e-03</span>   <span class="mxinfo" id="T1:U150">6.6309348e-03</span>   <span class="mxinfo" id="T1:U151">6.8775541e-03</span>   <span class="mxinfo" id="T1:U152">8.3371690e-03</span>   <span class="mxinfo" id="T1:U153">8.9468565e-03</span>   <span class="mxinfo" id="T1:U154">1.0554327e-02</span>   <span class="mxinfo" id="T1:U155">1.1562766e-02</span>   <span class="mxinfo" id="T1:U156">1.3414536e-02</span>   <span class="mxinfo" id="T1:U157">1.4879837e-02</span>   <span class="mxinfo" id="T1:U158">1.7084241e-02</span>   <span class="mxinfo" id="T1:U159">1.9088093e-02</span>   <span class="mxinfo" id="T1:U160">2.1768514e-02</span>   <span class="mxinfo" id="T1:U161">2.4416121e-02</span>   <span class="mxinfo" id="T1:U162">2.7711234e-02</span>   <span class="mxinfo" id="T1:U163">3.1127164e-02</span>   <span class="mxinfo" id="T1:U164">3.5184140e-02</span>   <span class="mxinfo" id="T1:U165">3.9497913e-02</span>   <span class="mxinfo" id="T1:U166">4.4449762e-02</span>   <span class="mxinfo" id="T1:U167">4.9758433e-02</span>   <span class="mxinfo" id="T1:U168">5.5667457e-02</span>   <span class="mxinfo" id="T1:U169">6.1949790e-02</span>   <span class="mxinfo" id="T1:U170">6.8682065e-02</span>   <span class="mxinfo" id="T1:U171">7.5616744e-02</span>   <span class="mxinfo" id="T1:U172">8.2584984e-02</span>   <span class="mxinfo" id="T1:U173">8.9193635e-02</span>   <span class="mxinfo" id="T1:U174">9.4874687e-02</span>   <span class="mxinfo" id="T1:U175">9.8891682e-02</span>   <span class="mxinfo" id="T1:U176">1.0004295e-01</span>   <span class="mxinfo" id="T1:U177">9.7016844e-02</span>   <span class="mxinfo" id="T1:U178">8.7789596e-02</span>   <span class="mxinfo" id="T1:U179">7.0509768e-02</span>   <span class="mxinfo" id="T1:U180">4.2778853e-02</span>   <span class="mxinfo" id="T1:U181">3.5584533e-03</span>  <span class="mxinfo" id="T1:U182">-<span class="mxinfo" id="T1:U183">4.7210453e-02</span></span>  <span class="mxinfo" id="T1:U184">-<span class="mxinfo" id="T1:U185">1.0489788e-01</span></span>  <span class="mxinfo" id="T1:U186">-<span class="mxinfo" id="T1:U187">1.6020950e-01</span></span>  <span class="mxinfo" id="T1:U188">-<span class="mxinfo" id="T1:U189">1.9459782e-01</span></span>  <span class="mxinfo" id="T1:U190">-<span class="mxinfo" id="T1:U191">1.8490775e-01</span></span>  <span class="mxinfo" id="T1:U192">-<span class="mxinfo" id="T1:U193">1.0754165e-01</span></span>   <span class="mxinfo" id="T1:U194">3.6037727e-02</span>   <span class="mxinfo" id="T1:U195">1.9759013e-01</span>   <span class="mxinfo" id="T1:U196">2.6132313e-01</span>   <span class="mxinfo" id="T1:U197">1.1713997e-01</span>  <span class="mxinfo" id="T1:U198">-<span class="mxinfo" id="T1:U199">1.8758779e-01</span></span>  <span class="mxinfo" id="T1:U200">-<span class="mxinfo" id="T1:U201">3.0238115e-01</span></span>   <span class="mxinfo" id="T1:U202">4.8163136e-02</span>   <span class="mxinfo" id="T1:U203">3.6399530e-01</span>  <span class="mxinfo" id="T1:U204">-<span class="mxinfo" id="T1:U205">1.4910233e-01</span></span>  <span class="mxinfo" id="T1:U206">-<span class="mxinfo" id="T1:U207">2.6373490e-01</span></span>   <span class="mxinfo" id="T1:U208">4.0362662e-01</span>  <span class="mxinfo" id="T1:U209">-<span class="mxinfo" id="T1:U210">3.1409795e-01</span></span>   <span class="mxinfo" id="T1:U211">1.8179369e-01</span>  <span class="mxinfo" id="T1:U212">-<span class="mxinfo" id="T1:U213">9.0738718e-02</span></span>   <span class="mxinfo" id="T1:U214">4.2946488e-02</span>  <span class="mxinfo" id="T1:U215">-<span class="mxinfo" id="T1:U216">2.0586136e-02</span></span>   <span class="mxinfo" id="T1:U217">1.0392667e-02</span>  <span class="mxinfo" id="T1:U218">-<span class="mxinfo" id="T1:U219">5.6117848e-03</span></span>   <span class="mxinfo" id="T1:U220">3.2402026e-03</span>  <span class="mxinfo" id="T1:U221">-<span class="mxinfo" id="T1:U222">1.9858724e-03</span></span>   <span class="mxinfo" id="T1:U223">1.2807317e-03</span>  <span class="mxinfo" id="T1:U224">-<span class="mxinfo" id="T1:U225">8.6253792e-04</span></span>   <span class="mxinfo" id="T1:U226">6.0296591e-04</span>  <span class="mxinfo" id="T1:U227">-<span class="mxinfo" id="T1:U228">4.3548937e-04</span></span>   <span class="mxinfo" id="T1:U229">3.2375892e-04</span>  <span class="mxinfo" id="T1:U230">-<span class="mxinfo" id="T1:U231">2.4698212e-04</span></span>   <span class="mxinfo" id="T1:U232">1.9279062e-04</span>  <span class="mxinfo" id="T1:U233">-<span class="mxinfo" id="T1:U234">1.5357912e-04</span></span>   <span class="mxinfo" id="T1:U235">1.2453788e-04</span>  <span class="mxinfo" id="T1:U236">-<span class="mxinfo" id="T1:U237">1.0255126e-04</span></span>   <span class="mxinfo" id="T1:U238">8.5558482e-05</span>  <span class="mxinfo" id="T1:U239">-<span class="mxinfo" id="T1:U240">7.2170928e-05</span></span>   <span class="mxinfo" id="T1:U241">6.1436863e-05</span>  <span class="mxinfo" id="T1:U242">-<span class="mxinfo" id="T1:U243">5.2693349e-05</span></span>   <span class="mxinfo" id="T1:U244">4.5471255e-05</span>  <span class="mxinfo" id="T1:U245">-<span class="mxinfo" id="T1:U246">3.9433284e-05</span></span>   <span class="mxinfo" id="T1:U247">3.4332971e-05</span>  <span class="mxinfo" id="T1:U248">-<span class="mxinfo" id="T1:U249">2.9987212e-05</span></span>   <span class="mxinfo" id="T1:U250">2.6257657e-05</span>  <span class="mxinfo" id="T1:U251">-<span class="mxinfo" id="T1:U252">2.3037978e-05</span></span>   <span class="mxinfo" id="T1:U253">2.0245071e-05</span>  <span class="mxinfo" id="T1:U254">-<span class="mxinfo" id="T1:U255">1.7812926e-05</span></span>   <span class="mxinfo" id="T1:U256">1.5688306e-05</span>  <span class="mxinfo" id="T1:U257">-<span class="mxinfo" id="T1:U258">1.3827679e-05</span></span>   <span class="mxinfo" id="T1:U259">1.2195005e-05</span>  <span class="mxinfo" id="T1:U260">-<span class="mxinfo" id="T1:U261">1.0760111e-05</span></span>   <span class="mxinfo" id="T1:U262">9.4974858e-06</span>  <span class="mxinfo" id="T1:U263">-<span class="mxinfo" id="T1:U264">8.3853711e-06</span></span>   <span class="mxinfo" id="T1:U265">7.4050613e-06</span>  <span class="mxinfo" id="T1:U266">-<span class="mxinfo" id="T1:U267">6.5403683e-06</span></span>   <span class="mxinfo" id="T1:U268">5.7772102e-06</span>  <span class="mxinfo" id="T1:U269">-<span class="mxinfo" id="T1:U270">5.1032933e-06</span></span>   <span class="mxinfo" id="T1:U271">4.5078641e-06</span>  <span class="mxinfo" id="T1:U272">-<span class="mxinfo" id="T1:U273">3.9815112e-06</span></span>   <span class="mxinfo" id="T1:U274">3.5159993e-06</span>  <span class="mxinfo" id="T1:U275">-<span class="mxinfo" id="T1:U276">3.1041250e-06</span></span>   <span class="mxinfo" id="T1:U277">2.7395854e-06</span>  <span class="mxinfo" id="T1:U278">-<span class="mxinfo" id="T1:U279">2.4168588e-06</span></span>   <span class="mxinfo" id="T1:U280">2.1310948e-06</span>  <span class="mxinfo" id="T1:U281">-<span class="mxinfo" id="T1:U282">1.8780186e-06</span></span>   <span class="mxinfo" id="T1:U283">1.6538488e-06</span>  <span class="mxinfo" id="T1:U284">-<span class="mxinfo" id="T1:U285">1.4552319e-06</span></span>   <span class="mxinfo" id="T1:U286">1.2791891e-06</span>  <span class="mxinfo" id="T1:U287">-<span class="mxinfo" id="T1:U288">1.1230742e-06</span></span>   <span class="mxinfo" id="T1:U289">9.8453631e-07</span>  <span class="mxinfo" id="T1:U290">-<span class="mxinfo" id="T1:U291">8.6148574e-07</span></span>   <span class="mxinfo" id="T1:U292">7.5206243e-07</span>  <span class="mxinfo" id="T1:U293">-<span class="mxinfo" id="T1:U294">6.5460810e-07</span></span>   <span class="mxinfo" id="T1:U295">5.6764452e-07</span>  <span class="mxinfo" id="T1:U296">-<span class="mxinfo" id="T1:U297">4.8985885e-07</span></span>   <span class="mxinfo" id="T1:U298">4.2009674e-07</span>  <span class="mxinfo" id="T1:U299">-<span class="mxinfo" id="T1:U300">3.5736213e-07</span></span>   <span class="mxinfo" id="T1:U301">3.0082216e-07</span>  <span class="mxinfo" id="T1:U302">-<span class="mxinfo" id="T1:U303">2.4981510e-07</span></span>   <span class="mxinfo" id="T1:U304">2.0385823e-07</span>  <span class="mxinfo" id="T1:U305">-<span class="mxinfo" id="T1:U306">1.6265189e-07</span></span>   <span class="mxinfo" id="T1:U307">1.2607417e-07</span>  <span class="mxinfo" id="T1:U308">-<span class="mxinfo" id="T1:U309">9.4158418e-08</span></span>   <span class="mxinfo" id="T1:U310">6.7043911e-08</span>  <span class="mxinfo" id="T1:U311">-<span class="mxinfo" id="T1:U312">4.4891091e-08</span></span>   <span class="mxinfo" id="T1:U313">2.7761326e-08</span>  <span class="mxinfo" id="T1:U314">-<span class="mxinfo" id="T1:U315">1.5480404e-08</span></span>   <span class="mxinfo" id="T1:U316">7.5327300e-09</span>  <span class="mxinfo" id="T1:U317">-<span class="mxinfo" id="T1:U318">3.0524770e-09</span></span>   <span class="mxinfo" id="T1:U319">9.5877856e-10</span>  <span class="mxinfo" id="T1:U320">-<span class="mxinfo" id="T1:U321">2.0575286e-10</span></span>   <span class="mxinfo" id="T1:U322">2.2414417e-11</span>]</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">    <span class="mxinfo" id="T28:U323"><span class="mxinfo" id="T28:U324"><span class="var type1" id="S21T27U360">Filter</span>.J1</span> = <span class="mxinfo" id="T28:U326"><span class="mxinfo" id="T29:U327">[   <span class="mxinfo" id="T1:U328">4.7827871e-10</span>  <span class="mxinfo" id="T1:U329">-<span class="mxinfo" id="T1:U330">2.9784176e-09</span></span>   <span class="mxinfo" id="T1:U331">9.7723833e-09</span>  <span class="mxinfo" id="T1:U332">-<span class="mxinfo" id="T1:U333">2.2382341e-08</span></span>   <span class="mxinfo" id="T1:U334">4.0446774e-08</span>  <span class="mxinfo" id="T1:U335">-<span class="mxinfo" id="T1:U336">6.1734816e-08</span></span>   <span class="mxinfo" id="T1:U337">8.3293912e-08</span>  <span class="mxinfo" id="T1:U338">-<span class="mxinfo" id="T1:U339">1.0249454e-07</span></span>   <span class="mxinfo" id="T1:U340">1.1780780e-07</span>  <span class="mxinfo" id="T1:U341">-<span class="mxinfo" id="T1:U342">1.2870061e-07</span></span>   <span class="mxinfo" id="T1:U343">1.3559243e-07</span>  <span class="mxinfo" id="T1:U344">-<span class="mxinfo" id="T1:U345">1.3921011e-07</span></span>   <span class="mxinfo" id="T1:U346">1.4065746e-07</span>  <span class="mxinfo" id="T1:U347">-<span class="mxinfo" id="T1:U348">1.4074882e-07</span></span>   <span class="mxinfo" id="T1:U349">1.4051721e-07</span>  <span class="mxinfo" id="T1:U350">-<span class="mxinfo" id="T1:U351">1.4040747e-07</span></span>   <span class="mxinfo" id="T1:U352">1.4127886e-07</span>  <span class="mxinfo" id="T1:U353">-<span class="mxinfo" id="T1:U354">1.4315596e-07</span></span>   <span class="mxinfo" id="T1:U355">1.4689283e-07</span>  <span class="mxinfo" id="T1:U356">-<span class="mxinfo" id="T1:U357">1.5210917e-07</span></span>   <span class="mxinfo" id="T1:U358">1.5989802e-07</span>  <span class="mxinfo" id="T1:U359">-<span class="mxinfo" id="T1:U360">1.6940918e-07</span></span>   <span class="mxinfo" id="T1:U361">1.8227089e-07</span>  <span class="mxinfo" id="T1:U362">-<span class="mxinfo" id="T1:U363">1.9695857e-07</span></span>   <span class="mxinfo" id="T1:U364">2.1603952e-07</span>  <span class="mxinfo" id="T1:U365">-<span class="mxinfo" id="T1:U366">2.3691321e-07</span></span>   <span class="mxinfo" id="T1:U367">2.6369843e-07</span>  <span class="mxinfo" id="T1:U368">-<span class="mxinfo" id="T1:U369">2.9202021e-07</span></span>   <span class="mxinfo" id="T1:U370">3.2852445e-07</span>  <span class="mxinfo" id="T1:U371">-<span class="mxinfo" id="T1:U372">3.6589095e-07</span></span>   <span class="mxinfo" id="T1:U373">4.1487501e-07</span>  <span class="mxinfo" id="T1:U374">-<span class="mxinfo" id="T1:U375">4.6327137e-07</span></span>   <span class="mxinfo" id="T1:U376">5.2852697e-07</span>  <span class="mxinfo" id="T1:U377">-<span class="mxinfo" id="T1:U378">5.9034984e-07</span></span>   <span class="mxinfo" id="T1:U379">6.7710212e-07</span>  <span class="mxinfo" id="T1:U380">-<span class="mxinfo" id="T1:U381">7.5512943e-07</span></span>   <span class="mxinfo" id="T1:U382">8.7062473e-07</span>  <span class="mxinfo" id="T1:U383">-<span class="mxinfo" id="T1:U384">9.6788531e-07</span></span>   <span class="mxinfo" id="T1:U385">1.1222658e-06</span>  <span class="mxinfo" id="T1:U386">-<span class="mxinfo" id="T1:U387">1.2417228e-06</span></span>   <span class="mxinfo" id="T1:U388">1.4493467e-06</span>  <span class="mxinfo" id="T1:U389">-<span class="mxinfo" id="T1:U390">1.5932457e-06</span></span>   <span class="mxinfo" id="T1:U391">1.8747046e-06</span>  <span class="mxinfo" id="T1:U392">-<span class="mxinfo" id="T1:U393">2.0433320e-06</span></span>   <span class="mxinfo" id="T1:U394">2.4285695e-06</span>  <span class="mxinfo" id="T1:U395">-<span class="mxinfo" id="T1:U396">2.6179926e-06</span></span>   <span class="mxinfo" id="T1:U397">3.1511730e-06</span>  <span class="mxinfo" id="T1:U398">-<span class="mxinfo" id="T1:U399">3.3492412e-06</span></span>   <span class="mxinfo" id="T1:U400">4.0964187e-06</span>  <span class="mxinfo" id="T1:U401">-<span class="mxinfo" id="T1:U402">4.2758276e-06</span></span>   <span class="mxinfo" id="T1:U403">5.3371198e-06</span>  <span class="mxinfo" id="T1:U404">-<span class="mxinfo" id="T1:U405">5.4435424e-06</span></span>   <span class="mxinfo" id="T1:U406">6.9725767e-06</span>  <span class="mxinfo" id="T1:U407">-<span class="mxinfo" id="T1:U408">6.9045563e-06</span></span>   <span class="mxinfo" id="T1:U409">9.1397025e-06</span>  <span class="mxinfo" id="T1:U410">-<span class="mxinfo" id="T1:U411">8.7148373e-06</span></span>   <span class="mxinfo" id="T1:U412">1.2029591e-05</span>  <span class="mxinfo" id="T1:U413">-<span class="mxinfo" id="T1:U414">1.0927977e-05</span></span>   <span class="mxinfo" id="T1:U415">1.5912527e-05</span>  <span class="mxinfo" id="T1:U416">-<span class="mxinfo" id="T1:U417">1.3582560e-05</span></span>   <span class="mxinfo" id="T1:U418">2.1176227e-05</span>  <span class="mxinfo" id="T1:U419">-<span class="mxinfo" id="T1:U420">1.6678206e-05</span></span>   <span class="mxinfo" id="T1:U421">2.8384979e-05</span>  <span class="mxinfo" id="T1:U422">-<span class="mxinfo" id="T1:U423">2.0132088e-05</span></span>   <span class="mxinfo" id="T1:U424">3.8372045e-05</span>  <span class="mxinfo" id="T1:U425">-<span class="mxinfo" id="T1:U426">2.3702184e-05</span></span>   <span class="mxinfo" id="T1:U427">5.2385309e-05</span>  <span class="mxinfo" id="T1:U428">-<span class="mxinfo" id="T1:U429">2.6854374e-05</span></span>   <span class="mxinfo" id="T1:U430">7.2318582e-05</span>  <span class="mxinfo" id="T1:U431">-<span class="mxinfo" id="T1:U432">2.8535362e-05</span></span>   <span class="mxinfo" id="T1:U433">1.0108123e-04</span>  <span class="mxinfo" id="T1:U434">-<span class="mxinfo" id="T1:U435">2.6788478e-05</span></span>   <span class="mxinfo" id="T1:U436">1.4319185e-04</span>  <span class="mxinfo" id="T1:U437">-<span class="mxinfo" id="T1:U438">1.8108424e-05</span></span>   <span class="mxinfo" id="T1:U439">2.0573562e-04</span>   <span class="mxinfo" id="T1:U440">3.6361649e-06</span>   <span class="mxinfo" id="T1:U441">2.9991265e-04</span>   <span class="mxinfo" id="T1:U442">4.8993332e-05</span>   <span class="mxinfo" id="T1:U443">4.4354734e-04</span>   <span class="mxinfo" id="T1:U444">1.3589102e-04</span>   <span class="mxinfo" id="T1:U445">6.6515824e-04</span>   <span class="mxinfo" id="T1:U446">2.9451992e-04</span>   <span class="mxinfo" id="T1:U447">1.0105554e-03</span>   <span class="mxinfo" id="T1:U448">5.7533965e-04</span>   <span class="mxinfo" id="T1:U449">1.5535077e-03</span>   <span class="mxinfo" id="T1:U450">1.0621193e-03</span>   <span class="mxinfo" id="T1:U451">2.4128970e-03</span>   <span class="mxinfo" id="T1:U452">1.8929698e-03</span>   <span class="mxinfo" id="T1:U453">3.7800178e-03</span>   <span class="mxinfo" id="T1:U454">3.2937343e-03</span>   <span class="mxinfo" id="T1:U455">5.9612180e-03</span>   <span class="mxinfo" id="T1:U456">5.6295935e-03</span>   <span class="mxinfo" id="T1:U457">9.4422527e-03</span>   <span class="mxinfo" id="T1:U458">9.4810228e-03</span>   <span class="mxinfo" id="T1:U459">1.4979159e-02</span>   <span class="mxinfo" id="T1:U460">1.5745093e-02</span>   <span class="mxinfo" id="T1:U461">2.3708966e-02</span>   <span class="mxinfo" id="T1:U462">2.5740591e-02</span>   <span class="mxinfo" id="T1:U463">3.7232783e-02</span>   <span class="mxinfo" id="T1:U464">4.1225009e-02</span>   <span class="mxinfo" id="T1:U465">5.7507103e-02</span>   <span class="mxinfo" id="T1:U466">6.4044643e-02</span>   <span class="mxinfo" id="T1:U467">8.6091797e-02</span>   <span class="mxinfo" id="T1:U468">9.4717140e-02</span>   <span class="mxinfo" id="T1:U469">1.2172497e-01</span>   <span class="mxinfo" id="T1:U470">1.2853597e-01</span>   <span class="mxinfo" id="T1:U471">1.5450777e-01</span>   <span class="mxinfo" id="T1:U472">1.4755964e-01</span>   <span class="mxinfo" id="T1:U473">1.5621399e-01</span>   <span class="mxinfo" id="T1:U474">1.1147621e-01</span>   <span class="mxinfo" id="T1:U475">7.7489831e-02</span>  <span class="mxinfo" id="T1:U476">-<span class="mxinfo" id="T1:U477">2.7628267e-02</span></span>  <span class="mxinfo" id="T1:U478">-<span class="mxinfo" id="T1:U479">1.0198730e-01</span></span>  <span class="mxinfo" id="T1:U480">-<span class="mxinfo" id="T1:U481">2.2039890e-01</span></span>  <span class="mxinfo" id="T1:U482">-<span class="mxinfo" id="T1:U483">2.1185763e-01</span></span>  <span class="mxinfo" id="T1:U484">-<span class="mxinfo" id="T1:U485">1.6052415e-01</span></span>   <span class="mxinfo" id="T1:U486">9.1649026e-02</span>   <span class="mxinfo" id="T1:U487">2.3792824e-01</span>   <span class="mxinfo" id="T1:U488">2.6075778e-01</span>  <span class="mxinfo" id="T1:U489">-<span class="mxinfo" id="T1:U490">1.5662188e-01</span></span>  <span class="mxinfo" id="T1:U491">-<span class="mxinfo" id="T1:U492">2.8932082e-01</span></span>   <span class="mxinfo" id="T1:U493">1.3148519e-02</span>   <span class="mxinfo" id="T1:U494">4.2691303e-01</span>  <span class="mxinfo" id="T1:U495">-<span class="mxinfo" id="T1:U496">4.0005050e-01</span></span>   <span class="mxinfo" id="T1:U497">1.1513789e-01</span>   <span class="mxinfo" id="T1:U498">9.3748244e-02</span>  <span class="mxinfo" id="T1:U499">-<span class="mxinfo" id="T1:U500">1.6037231e-01</span></span>   <span class="mxinfo" id="T1:U501">1.5071858e-01</span>  <span class="mxinfo" id="T1:U502">-<span class="mxinfo" id="T1:U503">1.2120369e-01</span></span>   <span class="mxinfo" id="T1:U504">9.4110656e-02</span>  <span class="mxinfo" id="T1:U505">-<span class="mxinfo" id="T1:U506">7.3742238e-02</span></span>   <span class="mxinfo" id="T1:U507">5.9038568e-02</span>  <span class="mxinfo" id="T1:U508">-<span class="mxinfo" id="T1:U509">4.8288118e-02</span></span>   <span class="mxinfo" id="T1:U510">4.0197054e-02</span>  <span class="mxinfo" id="T1:U511">-<span class="mxinfo" id="T1:U512">3.3919788e-02</span></span>   <span class="mxinfo" id="T1:U513">2.8918247e-02</span>  <span class="mxinfo" id="T1:U514">-<span class="mxinfo" id="T1:U515">2.4845272e-02</span></span>   <span class="mxinfo" id="T1:U516">2.1470450e-02</span>  <span class="mxinfo" id="T1:U517">-<span class="mxinfo" id="T1:U518">1.8635828e-02</span></span>   <span class="mxinfo" id="T1:U519">1.6229579e-02</span>  <span class="mxinfo" id="T1:U520">-<span class="mxinfo" id="T1:U521">1.4170085e-02</span></span>   <span class="mxinfo" id="T1:U522">1.2396084e-02</span>  <span class="mxinfo" id="T1:U523">-<span class="mxinfo" id="T1:U524">1.0860414e-02</span></span>   <span class="mxinfo" id="T1:U525">9.5259444e-03</span>  <span class="mxinfo" id="T1:U526">-<span class="mxinfo" id="T1:U527">8.3628577e-03</span></span>   <span class="mxinfo" id="T1:U528">7.3468030e-03</span>  <span class="mxinfo" id="T1:U529">-<span class="mxinfo" id="T1:U530">6.4576043e-03</span></span>   <span class="mxinfo" id="T1:U531">5.6783440e-03</span>  <span class="mxinfo" id="T1:U532">-<span class="mxinfo" id="T1:U533">4.9946949e-03</span></span>   <span class="mxinfo" id="T1:U534">4.3944258e-03</span>  <span class="mxinfo" id="T1:U535">-<span class="mxinfo" id="T1:U536">3.8670264e-03</span></span>   <span class="mxinfo" id="T1:U537">3.4034180e-03</span>  <span class="mxinfo" id="T1:U538">-<span class="mxinfo" id="T1:U539">2.9957261e-03</span></span>   <span class="mxinfo" id="T1:U540">2.6370977e-03</span>  <span class="mxinfo" id="T1:U541">-<span class="mxinfo" id="T1:U542">2.3215540e-03</span></span>   <span class="mxinfo" id="T1:U543">2.0438677e-03</span>  <span class="mxinfo" id="T1:U544">-<span class="mxinfo" id="T1:U545">1.7994617e-03</span></span>   <span class="mxinfo" id="T1:U546">1.5843227e-03</span>  <span class="mxinfo" id="T1:U547">-<span class="mxinfo" id="T1:U548">1.3949289e-03</span></span>   <span class="mxinfo" id="T1:U549">1.2281870e-03</span>  <span class="mxinfo" id="T1:U550">-<span class="mxinfo" id="T1:U551">1.0813787e-03</span></span>   <span class="mxinfo" id="T1:U552">9.5211407e-04</span>  <span class="mxinfo" id="T1:U553">-<span class="mxinfo" id="T1:U554">8.3829103e-04</span></span>   <span class="mxinfo" id="T1:U555">7.3806018e-04</span>  <span class="mxinfo" id="T1:U556">-<span class="mxinfo" id="T1:U557">6.4979407e-04</span></span>   <span class="mxinfo" id="T1:U558">5.7206023e-04</span>  <span class="mxinfo" id="T1:U559">-<span class="mxinfo" id="T1:U560">5.0359765e-04</span></span>   <span class="mxinfo" id="T1:U561">4.4329604e-04</span>  <span class="mxinfo" id="T1:U562">-<span class="mxinfo" id="T1:U563">3.9017773e-04</span></span>   <span class="mxinfo" id="T1:U564">3.4338167e-04</span>  <span class="mxinfo" id="T1:U565">-<span class="mxinfo" id="T1:U566">3.0214942e-04</span></span>   <span class="mxinfo" id="T1:U567">2.6581281e-04</span>  <span class="mxinfo" id="T1:U568">-<span class="mxinfo" id="T1:U569">2.3378310e-04</span></span>   <span class="mxinfo" id="T1:U570">2.0554144e-04</span>  <span class="mxinfo" id="T1:U571">-<span class="mxinfo" id="T1:U572">1.8063040e-04</span></span>   <span class="mxinfo" id="T1:U573">1.5864668e-04</span>  <span class="mxinfo" id="T1:U574">-<span class="mxinfo" id="T1:U575">1.3923451e-04</span></span>   <span class="mxinfo" id="T1:U576">1.2208003e-04</span>  <span class="mxinfo" id="T1:U577">-<span class="mxinfo" id="T1:U578">1.0690622e-04</span></span>   <span class="mxinfo" id="T1:U579">9.3468580e-05</span>  <span class="mxinfo" id="T1:U580">-<span class="mxinfo" id="T1:U581">8.1551329e-05</span></span>   <span class="mxinfo" id="T1:U582">7.0964175e-05</span>  <span class="mxinfo" id="T1:U583">-<span class="mxinfo" id="T1:U584">6.1539592e-05</span></span>   <span class="mxinfo" id="T1:U585">5.3130609e-05</span>  <span class="mxinfo" id="T1:U586">-<span class="mxinfo" id="T1:U587">4.5609106e-05</span></span>   <span class="mxinfo" id="T1:U588">3.8864649e-05</span>  <span class="mxinfo" id="T1:U589">-<span class="mxinfo" id="T1:U590">3.2803856e-05</span></span>   <span class="mxinfo" id="T1:U591">2.7350297e-05</span>  <span class="mxinfo" id="T1:U592">-<span class="mxinfo" id="T1:U593">2.2444816e-05</span></span>   <span class="mxinfo" id="T1:U594">1.8046076e-05</span>  <span class="mxinfo" id="T1:U595">-<span class="mxinfo" id="T1:U596">1.4130827e-05</span></span>   <span class="mxinfo" id="T1:U597">1.0693107e-05</span>  <span class="mxinfo" id="T1:U598">-<span class="mxinfo" id="T1:U599">7.7412053e-06</span></span>   <span class="mxinfo" id="T1:U600">5.2910576e-06</span>  <span class="mxinfo" id="T1:U601">-<span class="mxinfo" id="T1:U602">3.3552268e-06</span></span>   <span class="mxinfo" id="T1:U603">1.9282956e-06</span>  <span class="mxinfo" id="T1:U604">-<span class="mxinfo" id="T1:U605">9.7253713e-07</span></span>   <span class="mxinfo" id="T1:U606">4.1100808e-07</span>  <span class="mxinfo" id="T1:U607">-<span class="mxinfo" id="T1:U608">1.3553176e-07</span></span>   <span class="mxinfo" id="T1:U609">3.0748588e-08</span>  <span class="mxinfo" id="T1:U610">-<span class="mxinfo" id="T1:U611">3.5668195e-09</span></span>]</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">    <span class="mxinfo" id="T29:U612"><span class="mxinfo" id="T29:U613"><span class="var type1" id="S21T27U652">Filter</span>.base</span> = <span class="mxinfo" id="T29:U615">[   <span class="mxinfo" id="T1:U616">4.1185887e-06</span>   <span class="mxinfo" id="T1:U617">4.6623078e-06</span>   <span class="mxinfo" id="T1:U618">5.2778064e-06</span>   <span class="mxinfo" id="T1:U619">5.9745606e-06</span>   <span class="mxinfo" id="T1:U620">6.7632974e-06</span>   <span class="mxinfo" id="T1:U621">7.6561600e-06</span>   <span class="mxinfo" id="T1:U622">8.6668947e-06</span>   <span class="mxinfo" id="T1:U623">9.8110623e-06</span>   <span class="mxinfo" id="T1:U624">1.1106278e-05</span>   <span class="mxinfo" id="T1:U625">1.2572483e-05</span>   <span class="mxinfo" id="T1:U626">1.4232251e-05</span>   <span class="mxinfo" id="T1:U627">1.6111134e-05</span>   <span class="mxinfo" id="T1:U628">1.8238059e-05</span>   <span class="mxinfo" id="T1:U629">2.0645772e-05</span>   <span class="mxinfo" id="T1:U630">2.3371342e-05</span>   <span class="mxinfo" id="T1:U631">2.6456730e-05</span>   <span class="mxinfo" id="T1:U632">2.9949438e-05</span>   <span class="mxinfo" id="T1:U633">3.3903239e-05</span>   <span class="mxinfo" id="T1:U634">3.8379005e-05</span>   <span class="mxinfo" id="T1:U635">4.3445642e-05</span>   <span class="mxinfo" id="T1:U636">4.9181157e-05</span>   <span class="mxinfo" id="T1:U637">5.5673850e-05</span>   <span class="mxinfo" id="T1:U638">6.3023682e-05</span>   <span class="mxinfo" id="T1:U639">7.1343808e-05</span>   <span class="mxinfo" id="T1:U640">8.0762323e-05</span>   <span class="mxinfo" id="T1:U641">9.1424231e-05</span>   <span class="mxinfo" id="T1:U642">1.0349368e-04</span>   <span class="mxinfo" id="T1:U643">1.1715649e-04</span>   <span class="mxinfo" id="T1:U644">1.3262301e-04</span>   <span class="mxinfo" id="T1:U645">1.5013135e-04</span>   <span class="mxinfo" id="T1:U646">1.6995107e-04</span>   <span class="mxinfo" id="T1:U647">1.9238731e-04</span>   <span class="mxinfo" id="T1:U648">2.1778548e-04</span>   <span class="mxinfo" id="T1:U649">2.4653662e-04</span>   <span class="mxinfo" id="T1:U650">2.7908337e-04</span>   <span class="mxinfo" id="T1:U651">3.1592681e-04</span>   <span class="mxinfo" id="T1:U652">3.5763416e-04</span>   <span class="mxinfo" id="T1:U653">4.0484754e-04</span>   <span class="mxinfo" id="T1:U654">4.5829384e-04</span>   <span class="mxinfo" id="T1:U655">5.1879590e-04</span>   <span class="mxinfo" id="T1:U656">5.8728520e-04</span>   <span class="mxinfo" id="T1:U657">6.6481616e-04</span>   <span class="mxinfo" id="T1:U658">7.5258245e-04</span>   <span class="mxinfo" id="T1:U659">8.5193528e-04</span>   <span class="mxinfo" id="T1:U660">9.6440425e-04</span>   <span class="mxinfo" id="T1:U661">1.0917209e-03</span>   <span class="mxinfo" id="T1:U662">1.2358454e-03</span>   <span class="mxinfo" id="T1:U663">1.3989966e-03</span>   <span class="mxinfo" id="T1:U664">1.5836864e-03</span>   <span class="mxinfo" id="T1:U665">1.7927581e-03</span>   <span class="mxinfo" id="T1:U666">2.0294306e-03</span>   <span class="mxinfo" id="T1:U667">2.2973477e-03</span>   <span class="mxinfo" id="T1:U668">2.6006340e-03</span>   <span class="mxinfo" id="T1:U669">2.9439590e-03</span>   <span class="mxinfo" id="T1:U670">3.3326083e-03</span>   <span class="mxinfo" id="T1:U671">3.7725655e-03</span>   <span class="mxinfo" id="T1:U672">4.2706040e-03</span>   <span class="mxinfo" id="T1:U673">4.8343916e-03</span>   <span class="mxinfo" id="T1:U674">5.4726080e-03</span>   <span class="mxinfo" id="T1:U675">6.1950791e-03</span>   <span class="mxinfo" id="T1:U676">7.0129278e-03</span>   <span class="mxinfo" id="T1:U677">7.9387456e-03</span>   <span class="mxinfo" id="T1:U678">8.9867860e-03</span>   <span class="mxinfo" id="T1:U679">1.0173184e-02</span>   <span class="mxinfo" id="T1:U680">1.1516206e-02</span>   <span class="mxinfo" id="T1:U681">1.3036528e-02</span>   <span class="mxinfo" id="T1:U682">1.4757557e-02</span>   <span class="mxinfo" id="T1:U683">1.6705789e-02</span>   <span class="mxinfo" id="T1:U684">1.8911218e-02</span>   <span class="mxinfo" id="T1:U685">2.1407799e-02</span>   <span class="mxinfo" id="T1:U686">2.4233968e-02</span>   <span class="mxinfo" id="T1:U687">2.7433236e-02</span>   <span class="mxinfo" id="T1:U688">3.1054859e-02</span>   <span class="mxinfo" id="T1:U689">3.5154593e-02</span>   <span class="mxinfo" id="T1:U690">3.9795557e-02</span>   <span class="mxinfo" id="T1:U691">4.5049202e-02</span>   <span class="mxinfo" id="T1:U692">5.0996412e-02</span>   <span class="mxinfo" id="T1:U693">5.7728748e-02</span>   <span class="mxinfo" id="T1:U694">6.5349859e-02</span>   <span class="mxinfo" id="T1:U695">7.3977077e-02</span>   <span class="mxinfo" id="T1:U696">8.3743226e-02</span>   <span class="mxinfo" id="T1:U697">9.4798660e-02</span>   <span class="mxinfo" id="T1:U698">1.0731359e-01</span>   <span class="mxinfo" id="T1:U699">1.2148069e-01</span>   <span class="mxinfo" id="T1:U700">1.3751806e-01</span>   <span class="mxinfo" id="T1:U701">1.5567263e-01</span>   <span class="mxinfo" id="T1:U702">1.7622389e-01</span>   <span class="mxinfo" id="T1:U703">1.9948824e-01</span>   <span class="mxinfo" id="T1:U704">2.2582385e-01</span>   <span class="mxinfo" id="T1:U705">2.5563618e-01</span>   <span class="mxinfo" id="T1:U706">2.8938422e-01</span>   <span class="mxinfo" id="T1:U707">3.2758753e-01</span>   <span class="mxinfo" id="T1:U708">3.7083428e-01</span>   <span class="mxinfo" id="T1:U709">4.1979029e-01</span>   <span class="mxinfo" id="T1:U710">4.7520927e-01</span>   <span class="mxinfo" id="T1:U711">5.3794444e-01</span>   <span class="mxinfo" id="T1:U712">6.0896164e-01</span>   <span class="mxinfo" id="T1:U713">6.8935424e-01</span>   <span class="mxinfo" id="T1:U714">7.8035994e-01</span>   <span class="mxinfo" id="T1:U715">8.8337984e-01</span>   <span class="mxinfo" id="T1:U716">1.0000000e+00</span>   <span class="mxinfo" id="T1:U717">1.1320159e+00</span>   <span class="mxinfo" id="T1:U718">1.2814599e+00</span>   <span class="mxinfo" id="T1:U719">1.4506330e+00</span>   <span class="mxinfo" id="T1:U720">1.6421396e+00</span>   <span class="mxinfo" id="T1:U721">1.8589280e+00</span>   <span class="mxinfo" id="T1:U722">2.1043360e+00</span>   <span class="mxinfo" id="T1:U723">2.3821418e+00</span>   <span class="mxinfo" id="T1:U724">2.6966223e+00</span>   <span class="mxinfo" id="T1:U725">3.0526193e+00</span>   <span class="mxinfo" id="T1:U726">3.4556135e+00</span>   <span class="mxinfo" id="T1:U727">3.9118093e+00</span>   <span class="mxinfo" id="T1:U728">4.4282302e+00</span>   <span class="mxinfo" id="T1:U729">5.0128269e+00</span>   <span class="mxinfo" id="T1:U730">5.6745996e+00</span>   <span class="mxinfo" id="T1:U731">6.4237368e+00</span>   <span class="mxinfo" id="T1:U732">7.2717720e+00</span>   <span class="mxinfo" id="T1:U733">8.2317613e+00</span>   <span class="mxinfo" id="T1:U734">9.3184844e+00</span>   <span class="mxinfo" id="T1:U735">1.0548672e+01</span>   <span class="mxinfo" id="T1:U736">1.1941264e+01</span>   <span class="mxinfo" id="T1:U737">1.3517701e+01</span>   <span class="mxinfo" id="T1:U738">1.5302252e+01</span>   <span class="mxinfo" id="T1:U739">1.7322392e+01</span>   <span class="mxinfo" id="T1:U740">1.9609223e+01</span>   <span class="mxinfo" id="T1:U741">2.2197951e+01</span>   <span class="mxinfo" id="T1:U742">2.5128433e+01</span>   <span class="mxinfo" id="T1:U743">2.8445785e+01</span>   <span class="mxinfo" id="T1:U744">3.2201080e+01</span>   <span class="mxinfo" id="T1:U745">3.6452134e+01</span>   <span class="mxinfo" id="T1:U746">4.1264394e+01</span>   <span class="mxinfo" id="T1:U747">4.6711949e+01</span>   <span class="mxinfo" id="T1:U748">5.2878668e+01</span>   <span class="mxinfo" id="T1:U749">5.9859491e+01</span>   <span class="mxinfo" id="T1:U750">6.7761894e+01</span>   <span class="mxinfo" id="T1:U751">7.6707539e+01</span>   <span class="mxinfo" id="T1:U752">8.6834152e+01</span>   <span class="mxinfo" id="T1:U753">9.8297638e+01</span>   <span class="mxinfo" id="T1:U754">1.1127449e+02</span>   <span class="mxinfo" id="T1:U755">1.2596448e+02</span>   <span class="mxinfo" id="T1:U756">1.4259380e+02</span>   <span class="mxinfo" id="T1:U757">1.6141844e+02</span>   <span class="mxinfo" id="T1:U758">1.8272824e+02</span>   <span class="mxinfo" id="T1:U759">2.0685126e+02</span>   <span class="mxinfo" id="T1:U760">2.3415891e+02</span>   <span class="mxinfo" id="T1:U761">2.6507161e+02</span>   <span class="mxinfo" id="T1:U762">3.0006526e+02</span>   <span class="mxinfo" id="T1:U763">3.3967864e+02</span>   <span class="mxinfo" id="T1:U764">3.8452161e+02</span>   <span class="mxinfo" id="T1:U765">4.3528457e+02</span>   <span class="mxinfo" id="T1:U766">4.9274904e+02</span>   <span class="mxinfo" id="T1:U767">5.5779973e+02</span>   <span class="mxinfo" id="T1:U768">6.3143815e+02</span>   <span class="mxinfo" id="T1:U769">7.1479801e+02</span>   <span class="mxinfo" id="T1:U770">8.0916269e+02</span>   <span class="mxinfo" id="T1:U771">9.1598501e+02</span>   <span class="mxinfo" id="T1:U772">1.0369096e+03</span>   <span class="mxinfo" id="T1:U773">1.1737981e+03</span>   <span class="mxinfo" id="T1:U774">1.3287581e+03</span>   <span class="mxinfo" id="T1:U775">1.5041752e+03</span>   <span class="mxinfo" id="T1:U776">1.7027502e+03</span>   <span class="mxinfo" id="T1:U777">1.9275403e+03</span>   <span class="mxinfo" id="T1:U778">2.1820062e+03</span>   <span class="mxinfo" id="T1:U779">2.4700656e+03</span>   <span class="mxinfo" id="T1:U780">2.7961535e+03</span>   <span class="mxinfo" id="T1:U781">3.1652901e+03</span>   <span class="mxinfo" id="T1:U782">3.5831587e+03</span>   <span class="mxinfo" id="T1:U783">4.0561925e+03</span>   <span class="mxinfo" id="T1:U784">4.5916743e+03</span>   <span class="mxinfo" id="T1:U785">5.1978481e+03</span>   <span class="mxinfo" id="T1:U786">5.8840466e+03</span>   <span class="mxinfo" id="T1:U787">6.6608341e+03</span>   <span class="mxinfo" id="T1:U788">7.5401699e+03</span>   <span class="mxinfo" id="T1:U789">8.5355920e+03</span>   <span class="mxinfo" id="T1:U790">9.6624257e+03</span>   <span class="mxinfo" id="T1:U791">1.0938019e+04</span>   <span class="mxinfo" id="T1:U792">1.2382011e+04</span>   <span class="mxinfo" id="T1:U793">1.4016633e+04</span>   <span class="mxinfo" id="T1:U794">1.5867051e+04</span>   <span class="mxinfo" id="T1:U795">1.7961754e+04</span>   <span class="mxinfo" id="T1:U796">2.0332991e+04</span>   <span class="mxinfo" id="T1:U797">2.3017268e+04</span>   <span class="mxinfo" id="T1:U798">2.6055913e+04</span>   <span class="mxinfo" id="T1:U799">2.9495707e+04</span>   <span class="mxinfo" id="T1:U800">3.3389608e+04</span>   <span class="mxinfo" id="T1:U801">3.7797566e+04</span>   <span class="mxinfo" id="T1:U802">4.2787445e+04</span>   <span class="mxinfo" id="T1:U803">4.8436067e+04</span>   <span class="mxinfo" id="T1:U804">5.4830397e+04</span>   <span class="mxinfo" id="T1:U805">6.2068879e+04</span>   <span class="mxinfo" id="T1:U806">7.0262956e+04</span>   <span class="mxinfo" id="T1:U807">7.9538782e+04</span>   <span class="mxinfo" id="T1:U808">9.0039163e+04</span>   <span class="mxinfo" id="T1:U809">1.0192576e+05</span>   <span class="mxinfo" id="T1:U810">1.1538158e+05</span>   <span class="mxinfo" id="T1:U811">1.3061378e+05</span>   <span class="mxinfo" id="T1:U812">1.4785687e+05</span>   <span class="mxinfo" id="T1:U813">1.6737633e+05</span>   <span class="mxinfo" id="T1:U814">1.8947266e+05</span>   <span class="mxinfo" id="T1:U815">2.1448605e+05</span>   <span class="mxinfo" id="T1:U816">2.4280162e+05</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="comment">% Initialize output E structure:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">    <span class="mxinfo" id="T21:U817"><span class="var type1" id="S2T21U859">Er</span>    = <span class="mxinfo" id="T21:U819"><span class="mxinfo" id="T19:U820">1i</span>*<span class="mxinfo" id="T20:U821">zeros(<span class="mxinfo" id="T1:U822">length(<span class="var type1" id="S9T2U866">rRx</span>)</span>,<span class="mxinfo" id="T1:U824">length(<span class="var type1" id="S8T18U869">freqs</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">    <span class="mxinfo" id="T21:U826"><span class="var type1" id="S3T21U872">Eb</span>=<span class="var type1" id="S2T21U873">Er</span></span>;<span class="mxinfo" id="T21:U829"><span class="var type1" id="S4T21U876">Hr</span>=<span class="var type1" id="S2T21U877">Er</span></span>;<span class="mxinfo" id="T21:U832"><span class="var type1" id="S5T21U880">Hb</span>=<span class="var type1" id="S2T21U881">Er</span></span>;<span class="mxinfo" id="T21:U835"><span class="var type1" id="S6T21U884">Ez</span>=<span class="var type1" id="S2T21U885">Er</span></span>;<span class="mxinfo" id="T21:U838"><span class="var type1" id="S7T21U888">Hz</span>=<span class="var type1" id="S2T21U889">Er</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"><span class="comment">% Get lagged convulition setup:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line"><span class="comment">%for codegen </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">    <span class="mxinfo" id="T3:U841"><span class="var type1" id="S23T3U892">lambdaR</span> = <span class="mxinfo" id="T1:U843">1</span></span>;<span class="mxinfo" id="T3:U844"><span class="var type1" id="S24T3U896">rR</span>=<span class="mxinfo" id="T1:U846">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo" id="T5:U847"><span class="var type1" id="S15T1U902">lUseLaggedConv</span>==<span class="mxinfo" id="T1:U849">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">        <span class="mxinfo" id="T1:U850"><span class="var type1" id="S25T1U906">rMax</span>   = <span class="mxinfo" id="T1:U852">max(<span class="var type1" id="S9T2U909">rRx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">        <span class="mxinfo" id="T1:U854"><span class="var type1" id="S27T1U912">rMin</span>   = <span class="mxinfo" id="T1:U856">min(<span class="var type1" id="S9T2U915">rRx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">        <span class="mxinfo" id="T1:U858"><span class="var type1" id="S29T1U918">lamMin</span> = <span class="mxinfo" id="T1:U860"><span class="mxinfo" id="T1:U861"><span class="mxinfo" id="T29:U862"><span class="var type1" id="S21T27U922">Filter</span>.base</span>(<span class="mxinfo" id="T1:U864">1</span>)</span>/<span class="var type1" id="S25T1U925">rMax</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">        <span class="mxinfo" id="T1:U866"><span class="var type1" id="S30T1U928">lamMax</span> = <span class="mxinfo" id="T1:U868"><span class="mxinfo" id="T1:U869"><span class="mxinfo" id="T29:U870"><span class="var type1" id="S21T27U932">Filter</span>.base</span>(<span class="mxinfo" id="T1:U872">end</span>)</span>/<span class="var type1" id="S27T1U936">rMin</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">        <span class="mxinfo" id="T1:U874"><span class="var type1" id="S32T1U939">filterSpacing</span> = <span class="mxinfo" id="T1:U876"><span class="mxinfo" id="T1:U877"><span class="mxinfo" id="T29:U878"><span class="var type1" id="S21T27U943">Filter</span>.base</span>(<span class="mxinfo" id="T1:U880">2</span>)</span> / <span class="mxinfo" id="T1:U881"><span class="mxinfo" id="T29:U882"><span class="var type1" id="S21T27U948">Filter</span>.base</span>(<span class="mxinfo" id="T1:U884">1</span>)</span></span></span>; <span class="comment">% the filters are spaced by a multiplicative factor </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">        <span class="mxinfo" id="T1:U885"><span class="var type1" id="S33T1U953">nLambda</span>       = <span class="mxinfo" id="T1:U887"><span class="mxinfo" id="T1:U888">ceil(<span class="mxinfo" id="T1:U889"><span class="mxinfo" id="T1:U890">log(<span class="mxinfo" id="T1:U891"><span class="var type1" id="S30T1U961">lamMax</span>/<span class="var type1" id="S29T1U962">lamMin</span></span>)</span>/<span class="mxinfo" id="T1:U894">log(<span class="var type1" id="S32T1U965">filterSpacing</span>)</span></span>)</span>+<span class="mxinfo" id="T1:U896">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">        <span class="mxinfo" id="T3:U897"><span class="var type1" id="S23T3U969">lambdaR</span>       = <span class="mxinfo" id="T3:U899">exp(<span class="mxinfo" id="T3:U900"><span class="mxinfo" id="T1:U901">log(<span class="var type1" id="S29T1U976">lamMin</span>)</span>:<span class="mxinfo" id="T1:U903">log(<span class="var type1" id="S32T1U979">filterSpacing</span>)</span>:<span class="mxinfo" id="T1:U905"><span class="mxinfo" id="T1:U906">log(<span class="var type1" id="S29T1U983">lamMin</span>)</span>+<span class="mxinfo" id="T1:U908"><span class="mxinfo" id="T1:U909">log(<span class="var type1" id="S32T1U987">filterSpacing</span>)</span>*(<span class="mxinfo" id="T1:U911"><span class="var type1" id="S33T1U990">nLambda</span>-<span class="mxinfo" id="T1:U913">1</span></span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">        <span class="mxinfo" id="T1:U914"><span class="var type1" id="S37T1U994">nExtra</span>        = <span class="mxinfo" id="T1:U916"><span class="var type1" id="S33T1U996">nLambda</span> - <span class="mxinfo" id="T1:U918">length(<span class="var type1" id="S21T27U1000">Filter</span>.base)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">        <span class="mxinfo" id="T3:U920"><span class="var type1" id="S24T3U1004">rR</span>            = <span class="mxinfo" id="T3:U922"><span class="var type1" id="S25T1U1006">rMax</span>*<span class="mxinfo" id="T3:U924">exp(<span class="mxinfo" id="T3:U925"><span class="mxinfo" id="T3:U926">-<span class="mxinfo" id="T3:U927">[0:<span class="var type1" id="S37T1U1015">nExtra</span>]</span></span>*<span class="mxinfo" id="T1:U929">log(<span class="var type1" id="S32T1U1018">filterSpacing</span>)</span></span>)</span></span></span>; <span class="comment">% ranges corresponding to lambdaR plus nExtra 1 lags in convolution:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">        <span class="comment">%define EH(k) here for lagged convolution</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">        <span class="mxinfo" id="T21:U931"><span class="var type1" id="S38T21U1021">EHK</span>   = <span class="mxinfo" id="T21:U933"><span class="mxinfo" id="T19:U934">1i</span>*<span class="mxinfo" id="T20:U935">zeros(<span class="mxinfo" id="T1:U936"><span class="mxinfo" id="T1:U937">10</span>*<span class="mxinfo" id="T1:U938">length(<span class="var type1" id="S8T18U1030">freqs</span>)</span></span>,<span class="mxinfo" id="T1:U940">length(<span class="var type1" id="S23T3U1033">lambdaR</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">        <span class="mxinfo" id="T21:U942"><span class="var type1" id="S38T21U1037">EHK</span>   = <span class="mxinfo" id="T32:U944"><span class="mxinfo" id="T19:U945">1i</span>*<span class="mxinfo" id="T31:U946">zeros(10,length(<span class="var type1" id="S21T27U1046">Filter</span>.base))</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"><span class="comment">% Now compute the CSEM responses using the FHT method:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">    <span class="comment">%[freqs indF] = sort(freqs); % sort from low to high</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">    <span class="comment">% Loop over frequencies:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">        <span class="mxinfo" id="T1:U948"><span class="var type1" id="S39T1U1050">nF</span> = <span class="mxinfo" id="T1:U950">length (<span class="var type1" id="S8T18U1053">freqs</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T5:U952"><span class="var type1" id="S15T1U1058">lUseLaggedConv</span>==<span class="mxinfo" id="T1:U954">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">            <span class="mxinfo" id="T3:U955"><span class="var type1" id="S40T3U1062">lambda</span> = <span class="var type1" id="S23T3U1063">lambdaR</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">            <span class="mxinfo" id="T1:U958"><span class="var type1" id="S41T1U1066">zRxEval</span> = <span class="mxinfo" id="T1:U960"><span class="var type1" id="S10T2U1068">zRx</span>(<span class="mxinfo" id="T1:U962">1</span>)</span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">            <span class="mxinfo" id="T21:U963"><span class="var type1" id="S42T21U1072">eyBase</span> = <span class="mxinfo" id="T21:U965"><span class="mxinfo" id="T19:U966">1i</span>*<span class="mxinfo" id="T20:U967">zeros(<span class="mxinfo" id="T1:U968">length(<span class="var type1" id="S24T3U1079">rR</span>)</span>,<span class="mxinfo" id="T1:U970"><span class="mxinfo" id="T1:U971">6</span>*<span class="var type1" id="S39T1U1082">nF</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">            <span class="comment">% Get the kernels for all lambdas</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S43T1U1085">iFreq</span> = <span class="mxinfo" id="T1:U974">1</span>:<span class="var type1" id="S39T1U1088">nF</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">                <span class="mxinfo" id="T1:U976"><span class="var type1" id="S44T1U1091">f</span> = <span class="mxinfo" id="T1:U978"><span class="var type1" id="S8T18U1093">freqs</span>(<span class="var type1" id="S43T1U1094">iFreq</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S45T1U1097">i</span> = <span class="mxinfo" id="T1:U982">1</span>:<span class="mxinfo" id="T1:U983">length(<span class="var type1" id="S40T3U1102">lambda</span>)</span>   </span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">                    <span class="comment">%EyKR(1:2,i) = getCSEM1DKernels_aniso_hed(lambda(i),f,zRxEval,zTx,z,sig);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">                    <span class="comment">%all components of the EH field</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">                    <span class="mxinfo" id="T46:U985">[<span class="var type1" id="S46T46U1106">ErK</span>,<span class="var type1" id="S47T46U1107">EbK</span>,<span class="var type1" id="S48T46U1108">HrK</span>,<span class="var type1" id="S49T46U1109">HbK</span>,<span class="var type1" id="S50T19U1110">EzK</span>,<span class="var type1" id="S51T19U1111">HzK</span>] = <span class="fcn" id="F239N8:B1113">getCSEM1DKernels_aniso_hed</span>(<span class="mxinfo" id="T1:U992"><span class="var type1" id="S40T3U1115">lambda</span>(<span class="var type1" id="S45T1U1116">i</span>)</span>,<span class="var type1" id="S44T1U1117">f</span>,<span class="var type1" id="S41T1U1118">zRxEval</span>,<span class="var type1" id="S11T1U1119">zTx</span>,<span class="var type1" id="S12T2U1120">z</span>,<span class="var type1" id="S13T33U1121">sig</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">                    <span class="mxinfo" id="T46:U1000"><span class="mxinfo" id="T46:U1001"><span class="var type1" id="S38T21U1125">EHK</span>(<span class="mxinfo" id="T53:U1003">(<span class="mxinfo" id="T1:U1004"><span class="mxinfo" id="T1:U1005">2</span>*<span class="var type1" id="S43T1U1131">iFreq</span>-1</span>):<span class="mxinfo" id="T1:U1007">2</span>*<span class="var type1" id="S43T1U1135">iFreq</span></span>,<span class="var type1" id="S45T1U1136">i</span>)</span>=<span class="var type1" id="S46T46U1137">ErK</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">                    <span class="mxinfo" id="T48:U1011"><span class="mxinfo" id="T48:U1012"><span class="var type1" id="S38T21U1141">EHK</span>(<span class="mxinfo" id="T1:U1014"><span class="mxinfo" id="T1:U1015"><span class="mxinfo" id="T1:U1016"><span class="mxinfo" id="T1:U1017">2</span>*<span class="var type1" id="S39T1U1146">nF</span></span>+(<span class="mxinfo" id="T1:U1019"><span class="mxinfo" id="T1:U1020"><span class="mxinfo" id="T1:U1021">2</span>*<span class="var type1" id="S43T1U1151">iFreq</span></span>-<span class="mxinfo" id="T1:U1023">1</span></span>)</span>:<span class="mxinfo" id="T1:U1024"><span class="mxinfo" id="T1:U1025"><span class="mxinfo" id="T1:U1026">2</span>*<span class="var type1" id="S39T1U1156">nF</span></span>+<span class="mxinfo" id="T1:U1028"><span class="mxinfo" id="T1:U1029">2</span>*<span class="var type1" id="S43T1U1159">iFreq</span></span></span></span>,<span class="var type1" id="S45T1U1160">i</span>)</span>=<span class="var type1" id="S47T46U1161">EbK</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">                    <span class="mxinfo" id="T48:U1033"><span class="mxinfo" id="T48:U1034"><span class="var type1" id="S38T21U1165">EHK</span>(<span class="mxinfo" id="T1:U1036"><span class="mxinfo" id="T1:U1037"><span class="mxinfo" id="T1:U1038"><span class="mxinfo" id="T1:U1039">4</span>*<span class="var type1" id="S39T1U1170">nF</span></span>+(<span class="mxinfo" id="T1:U1041"><span class="mxinfo" id="T1:U1042"><span class="mxinfo" id="T1:U1043">2</span>*<span class="var type1" id="S43T1U1175">iFreq</span></span>-<span class="mxinfo" id="T1:U1045">1</span></span>)</span>:<span class="mxinfo" id="T1:U1046"><span class="mxinfo" id="T1:U1047"><span class="mxinfo" id="T1:U1048">4</span>*<span class="var type1" id="S39T1U1180">nF</span></span>+<span class="mxinfo" id="T1:U1050"><span class="mxinfo" id="T1:U1051">2</span>*<span class="var type1" id="S43T1U1183">iFreq</span></span></span></span>,<span class="var type1" id="S45T1U1184">i</span>)</span>=<span class="var type1" id="S48T46U1185">HrK</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">                    <span class="mxinfo" id="T48:U1055"><span class="mxinfo" id="T48:U1056"><span class="var type1" id="S38T21U1189">EHK</span>(<span class="mxinfo" id="T1:U1058"><span class="mxinfo" id="T1:U1059"><span class="mxinfo" id="T1:U1060"><span class="mxinfo" id="T1:U1061">6</span>*<span class="var type1" id="S39T1U1194">nF</span></span>+(<span class="mxinfo" id="T1:U1063"><span class="mxinfo" id="T1:U1064"><span class="mxinfo" id="T1:U1065">2</span>*<span class="var type1" id="S43T1U1199">iFreq</span></span>-<span class="mxinfo" id="T1:U1067">1</span></span>)</span>:<span class="mxinfo" id="T1:U1068"><span class="mxinfo" id="T1:U1069"><span class="mxinfo" id="T1:U1070">6</span>*<span class="var type1" id="S39T1U1204">nF</span></span>+<span class="mxinfo" id="T1:U1072"><span class="mxinfo" id="T1:U1073">2</span>*<span class="var type1" id="S43T1U1207">iFreq</span></span></span></span>,<span class="var type1" id="S45T1U1208">i</span>)</span>=<span class="var type1" id="S49T46U1209">HbK</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">                    <span class="mxinfo" id="T19:U1077"><span class="mxinfo" id="T19:U1078"><span class="var type1" id="S38T21U1213">EHK</span>(<span class="mxinfo" id="T1:U1080"><span class="mxinfo" id="T1:U1081"><span class="mxinfo" id="T1:U1082">8</span>*<span class="var type1" id="S39T1U1217">nF</span></span>+<span class="var type1" id="S43T1U1218">iFreq</span></span>,<span class="var type1" id="S45T1U1219">i</span>)</span>=<span class="var type1" id="S50T19U1220">EzK</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">                    <span class="mxinfo" id="T19:U1087"><span class="mxinfo" id="T19:U1088"><span class="var type1" id="S38T21U1224">EHK</span>(<span class="mxinfo" id="T1:U1090"><span class="mxinfo" id="T1:U1091"><span class="mxinfo" id="T1:U1092">9</span>*<span class="var type1" id="S39T1U1228">nF</span></span>+<span class="var type1" id="S43T1U1229">iFreq</span></span>,<span class="var type1" id="S45T1U1230">i</span>)</span>=<span class="var type1" id="S51T19U1231">HzK</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">            <span class="keyword">end</span> <span class="comment">% loop over frequencies</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">            <span class="comment">% Extract results for all rR ranges:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S53T1U1234">irR</span> = <span class="mxinfo" id="T1:U1098">1</span>:<span class="mxinfo" id="T1:U1099">length(<span class="var type1" id="S24T3U1239">rR</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">                <span class="mxinfo" id="T29:U1101"><span class="var type1" id="S54T29U1242">iShift</span> = <span class="mxinfo" id="T29:U1103"><span class="mxinfo" id="T29:U1104"><span class="mxinfo" id="T29:U1105">[1:length(<span class="var type1" id="S21T27U1252">Filter</span>.base)]</span>+<span class="var type1" id="S53T1U1254">irR</span></span>-<span class="mxinfo" id="T1:U1108">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">                <span class="mxinfo" id="T36:U1109"><span class="mxinfo" id="T36:U1110"><span class="var type1" id="S42T21U1259">eyBase</span>(<span class="var type1" id="S53T1U1260">irR</span>,<span class="mxinfo" id="T1:U1113"><span class="mxinfo" id="T1:U1114"><span class="mxinfo" id="T1:U1115"><span class="mxinfo" id="T1:U1116">4</span>*<span class="var type1" id="S39T1U1265">nF</span></span>+<span class="mxinfo" id="T1:U1118">1</span></span>:<span class="mxinfo" id="T1:U1119"><span class="mxinfo" id="T1:U1120">6</span>*<span class="var type1" id="S39T1U1269">nF</span></span></span>,:)</span> = <span class="mxinfo" id="T48:U1122">(<span class="mxinfo" id="T48:U1123"><span class="mxinfo" id="T47:U1124"><span class="var type1" id="S38T21U1275">EHK</span>(<span class="mxinfo" id="T1:U1126"><span class="mxinfo" id="T1:U1127"><span class="mxinfo" id="T1:U1128"><span class="mxinfo" id="T1:U1129">8</span>*<span class="var type1" id="S39T1U1280">nF</span></span>+<span class="mxinfo" id="T1:U1131">1</span></span>:<span class="mxinfo" id="T1:U1132"><span class="mxinfo" id="T1:U1133">10</span>*<span class="var type1" id="S39T1U1284">nF</span></span></span>,<span class="var type1" id="S54T29U1285">iShift</span>)</span>*<span class="mxinfo" id="T28:U1136"><span class="var type1" id="S21T27U1287">Filter</span>.J1</span></span>)/<span class="mxinfo" id="T1:U1138"><span class="var type1" id="S24T3U1290">rR</span>(<span class="var type1" id="S53T1U1291">irR</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">                <span class="mxinfo" id="T36:U1141"><span class="mxinfo" id="T36:U1142"><span class="var type1" id="S42T21U1295">eyBase</span>(<span class="var type1" id="S53T1U1296">irR</span>,<span class="mxinfo" id="T1:U1145"><span class="mxinfo" id="T1:U1146">1</span>:<span class="mxinfo" id="T1:U1147"><span class="mxinfo" id="T1:U1148">4</span>*<span class="var type1" id="S39T1U1301">nF</span></span></span>,:)</span>= <span class="mxinfo" id="T48:U1150">(<span class="mxinfo" id="T48:U1151"><span class="mxinfo" id="T49:U1152">[<span class="mxinfo" id="T47:U1153"><span class="var type1" id="S38T21U1309">EHK</span>(<span class="mxinfo" id="T1:U1155"><span class="mxinfo" id="T1:U1156">1</span>:<span class="mxinfo" id="T1:U1157">2</span>:<span class="mxinfo" id="T1:U1158"><span class="mxinfo" id="T1:U1159"><span class="mxinfo" id="T1:U1160">8</span>*<span class="var type1" id="S39T1U1317">nF</span></span>-<span class="mxinfo" id="T1:U1162">1</span></span></span>,<span class="var type1" id="S54T29U1319">iShift</span>)</span>,<span class="mxinfo" id="T47:U1164"><span class="var type1" id="S38T21U1321">EHK</span>(<span class="mxinfo" id="T1:U1166"><span class="mxinfo" id="T1:U1167">2</span>:<span class="mxinfo" id="T1:U1168">2</span>:<span class="mxinfo" id="T1:U1169"><span class="mxinfo" id="T1:U1170">8</span>*<span class="var type1" id="S39T1U1328">nF</span></span></span>,<span class="var type1" id="S54T29U1329">iShift</span>,:)</span>]</span>*<span class="mxinfo" id="T50:U1173">[<span class="mxinfo" id="T28:U1174"><span class="var type1" id="S21T27U1334">Filter</span>.J0</span>;<span class="mxinfo" id="T28:U1176"><span class="mxinfo" id="T28:U1177"><span class="var type1" id="S21T27U1339">Filter</span>.J1</span>/<span class="mxinfo" id="T1:U1179"><span class="var type1" id="S24T3U1342">rR</span>(<span class="var type1" id="S53T1U1343">irR</span>)</span></span>]</span></span>)/<span class="mxinfo" id="T1:U1182"><span class="var type1" id="S24T3U1345">rR</span>(<span class="var type1" id="S53T1U1346">irR</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">            <span class="comment">% Compute spline coefficients:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">             <span class="comment">%PP=spline(log10(rR) ,eyBase');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">             <span class="mxinfo" id="T51:U1185"><span class="var type1" id="S55T51U1349">PPV</span>=<span class="mxinfo" id="T51:U1187"><span class="extrinsicFcn" id="F309N11:B1351">spline</span>(<span class="mxinfo" id="T3:U1188">log10(<span class="var type1" id="S24T3U1354">rR</span>)</span> ,<span class="mxinfo" id="T21:U1190"><span class="var type1" id="S42T21U1356">eyBase</span>'</span>,<span class="mxinfo" id="T3:U1192">log10(<span class="var type1" id="S9T2U1359">rRx</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">             <span class="mxinfo" id="T21:U1194"><span class="var type1" id="S58T21U1362">EH</span> = <span class="mxinfo" id="T21:U1196"><span class="mxinfo" id="T19:U1197">1i</span>*<span class="mxinfo" id="T20:U1198">zeros(<span class="mxinfo" id="T1:U1199"><span class="mxinfo" id="T1:U1200">6</span>*<span class="var type1" id="S39T1U1369">nF</span></span>,<span class="mxinfo" id="T1:U1202">length(<span class="var type1" id="S9T2U1372">rRx</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line">            <span class="comment">% PPV = ppval(PP,log10(rRx));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line">             <span class="mxinfo" id="T21:U1204"><span class="var type1" id="S58T21U1375">EH</span> = <span class="var type1" id="S55T51U1376">PPV</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line">           </span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line">             <span class="mxinfo" id="T21:U1207"><span class="var type1" id="S2T21U1379">Er</span> = <span class="mxinfo" id="T21:U1209"><span class="mxinfo" id="T21:U1210"><span class="var type1" id="S58T21U1382">EH</span>(<span class="mxinfo" id="T1:U1212"><span class="mxinfo" id="T1:U1213">1</span>:<span class="var type1" id="S39T1U1385">nF</span></span>,:)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line">             <span class="mxinfo" id="T21:U1215"><span class="var type1" id="S3T21U1389">Eb</span> = <span class="mxinfo" id="T21:U1217"><span class="mxinfo" id="T21:U1218"><span class="var type1" id="S58T21U1392">EH</span>(  <span class="mxinfo" id="T1:U1220"><span class="mxinfo" id="T1:U1221"><span class="var type1" id="S39T1U1395">nF</span>+<span class="mxinfo" id="T1:U1223">1</span></span>:<span class="mxinfo" id="T1:U1224"><span class="mxinfo" id="T1:U1225">2</span>*<span class="var type1" id="S39T1U1399">nF</span></span></span>,:)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line">             <span class="mxinfo" id="T21:U1227"><span class="var type1" id="S4T21U1403">Hr</span> = <span class="mxinfo" id="T21:U1229"><span class="mxinfo" id="T21:U1230"><span class="var type1" id="S58T21U1406">EH</span>(<span class="mxinfo" id="T1:U1232"><span class="mxinfo" id="T1:U1233"><span class="mxinfo" id="T1:U1234"><span class="mxinfo" id="T1:U1235">2</span>*<span class="var type1" id="S39T1U1411">nF</span></span>+<span class="mxinfo" id="T1:U1237">1</span></span>:<span class="mxinfo" id="T1:U1238"><span class="mxinfo" id="T1:U1239">3</span>*<span class="var type1" id="S39T1U1415">nF</span></span></span>,:)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line">             <span class="mxinfo" id="T21:U1241"><span class="var type1" id="S5T21U1419">Hb</span> = <span class="mxinfo" id="T21:U1243"><span class="mxinfo" id="T21:U1244"><span class="var type1" id="S58T21U1422">EH</span>(<span class="mxinfo" id="T1:U1246"><span class="mxinfo" id="T1:U1247"><span class="mxinfo" id="T1:U1248"><span class="mxinfo" id="T1:U1249">3</span>*<span class="var type1" id="S39T1U1427">nF</span></span>+<span class="mxinfo" id="T1:U1251">1</span></span>:<span class="mxinfo" id="T1:U1252"><span class="mxinfo" id="T1:U1253">4</span>*<span class="var type1" id="S39T1U1431">nF</span></span></span>,:)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line">             <span class="mxinfo" id="T21:U1255"><span class="var type1" id="S6T21U1435">Ez</span> = <span class="mxinfo" id="T21:U1257"><span class="mxinfo" id="T21:U1258"><span class="var type1" id="S58T21U1438">EH</span>(<span class="mxinfo" id="T1:U1260"><span class="mxinfo" id="T1:U1261"><span class="mxinfo" id="T1:U1262"><span class="mxinfo" id="T1:U1263">4</span>*<span class="var type1" id="S39T1U1443">nF</span></span>+<span class="mxinfo" id="T1:U1265">1</span></span>:<span class="mxinfo" id="T1:U1266"><span class="mxinfo" id="T1:U1267">5</span>*<span class="var type1" id="S39T1U1447">nF</span></span></span>,:)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line">             <span class="mxinfo" id="T21:U1269"><span class="var type1" id="S7T21U1451">Hz</span> = <span class="mxinfo" id="T21:U1271"><span class="mxinfo" id="T21:U1272"><span class="var type1" id="S58T21U1454">EH</span>(<span class="mxinfo" id="T1:U1274"><span class="mxinfo" id="T1:U1275"><span class="mxinfo" id="T1:U1276"><span class="mxinfo" id="T1:U1277">5</span>*<span class="var type1" id="S39T1U1459">nF</span></span>+<span class="mxinfo" id="T1:U1279">1</span></span>:<span class="mxinfo" id="T1:U1280"><span class="mxinfo" id="T1:U1281">6</span>*<span class="var type1" id="S39T1U1463">nF</span></span></span>,:)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line">        <span class="keyword">else</span> <span class="comment">% Normal call without the lagged convolution + spline approximations:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line">             <span class="keyword">for</span> <span class="var type1" id="S43T1U1468">iFreq</span> = <span class="mxinfo" id="T1:U1284">1</span>:<span class="var type1" id="S39T1U1471">nF</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line">                <span class="mxinfo" id="T1:U1286"><span class="var type1" id="S44T1U1474">f</span> = <span class="mxinfo" id="T1:U1288"><span class="var type1" id="S8T18U1476">freqs</span>(<span class="var type1" id="S43T1U1477">iFreq</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line">                <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line">                <span class="comment">% Loop over receivers</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line">                <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S59T1U1480">iRx</span> = <span class="mxinfo" id="T1:U1292">1</span>:<span class="mxinfo" id="T1:U1293">length(<span class="var type1" id="S9T2U1485">rRx</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line">                    <span class="mxinfo" id="T1:U1295"><span class="var type1" id="S60T1U1488">rRxEval</span> = <span class="mxinfo" id="T1:U1297"><span class="var type1" id="S9T2U1490">rRx</span>(<span class="var type1" id="S59T1U1491">iRx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line">                    <span class="mxinfo" id="T1:U1300"><span class="var type1" id="S41T1U1494">zRxEval</span> = <span class="mxinfo" id="T1:U1302"><span class="var type1" id="S10T2U1496">zRx</span>(<span class="var type1" id="S59T1U1497">iRx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line">                    <span class="comment">%tstart = tic; % start the timer</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line">                    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">                    <span class="comment">% Get the lambda values for this particular range rRxEval:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line">                    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line">                    <span class="mxinfo" id="T29:U1305"><span class="var type1" id="S40T29U1500">lambda</span> =  <span class="mxinfo" id="T29:U1307"><span class="mxinfo" id="T29:U1308"><span class="var type1" id="S21T27U1503">Filter</span>.base</span>/<span class="var type1" id="S60T1U1505">rRxEval</span></span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line">                    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line">                    <span class="comment">% Get kernels for the particular lambda's</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line">                    <span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line">                    <span class="keyword">for</span> <span class="var type1" id="S45T1U1508">i</span> = <span class="mxinfo" id="T1:U1312">1</span>:length(<span class="var type1" id="S40T29U1513">lambda</span>)   </span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line">                        <span class="comment">%all components of the EH field</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line">                         <span class="mxinfo" id="T46:U1314">[<span class="var type1" id="S46T46U1517">ErK</span>,<span class="var type1" id="S47T46U1518">EbK</span>,<span class="var type1" id="S48T46U1519">HrK</span>,<span class="var type1" id="S49T46U1520">HbK</span>,<span class="var type1" id="S50T19U1521">EzK</span>,<span class="var type1" id="S51T19U1522">HzK</span>] = <span class="fcn" id="F239N8:B1524">getCSEM1DKernels_aniso_hed</span>(<span class="mxinfo" id="T1:U1321"><span class="var type1" id="S40T29U1526">lambda</span>(<span class="var type1" id="S45T1U1527">i</span>)</span>,<span class="var type1" id="S44T1U1528">f</span>,<span class="var type1" id="S41T1U1529">zRxEval</span>,<span class="var type1" id="S11T1U1530">zTx</span>,<span class="var type1" id="S12T2U1531">z</span>,<span class="var type1" id="S13T33U1532">sig</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line">                         <span class="mxinfo" id="T54:U1329"><span class="mxinfo" id="T54:U1330"><span class="var type1" id="S38T21U1536">EHK</span>(<span class="mxinfo" id="T55:U1332"><span class="mxinfo" id="T1:U1333">1</span>:<span class="mxinfo" id="T1:U1334">10</span></span>,<span class="var type1" id="S45T1U1540">i</span>)</span>=<span class="mxinfo" id="T54:U1336">[<span class="var type1" id="S46T46U1543">ErK</span>;<span class="var type1" id="S47T46U1545">EbK</span>;<span class="var type1" id="S48T46U1547">HrK</span>;<span class="var type1" id="S49T46U1549">HbK</span>;<span class="var type1" id="S50T19U1551">EzK</span>;<span class="var type1" id="S51T19U1553">HzK</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line">                    <span class="keyword">end</span>    </span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line">                    <span class="comment">% Don't forget to scale the J1 kernel by 1/r for</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line">                    <span class="comment">% Er,Eb,Hr,Hb</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line">                    <span class="mxinfo" id="T36:U1343"><span class="mxinfo" id="T36:U1344"><span class="var type1" id="S38T21U1557">EHK</span>(<span class="mxinfo" id="T1:U1346">2</span>,:)</span> = <span class="mxinfo" id="T36:U1347"><span class="mxinfo" id="T36:U1348"><span class="var type1" id="S38T21U1562">EHK</span>(<span class="mxinfo" id="T1:U1350">2</span>,:)</span>/<span class="var type1" id="S60T1U1565">rRxEval</span></span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line">                    <span class="mxinfo" id="T36:U1352"><span class="mxinfo" id="T36:U1353"><span class="var type1" id="S38T21U1569">EHK</span>(<span class="mxinfo" id="T1:U1355">4</span>,:)</span> = <span class="mxinfo" id="T36:U1356"><span class="mxinfo" id="T36:U1357"><span class="var type1" id="S38T21U1574">EHK</span>(<span class="mxinfo" id="T1:U1359">4</span>,:)</span>/<span class="var type1" id="S60T1U1577">rRxEval</span></span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line">                    <span class="mxinfo" id="T36:U1361"><span class="mxinfo" id="T36:U1362"><span class="var type1" id="S38T21U1581">EHK</span>(<span class="mxinfo" id="T1:U1364">6</span>,:)</span> = <span class="mxinfo" id="T36:U1365"><span class="mxinfo" id="T36:U1366"><span class="var type1" id="S38T21U1586">EHK</span>(<span class="mxinfo" id="T1:U1368">6</span>,:)</span>/<span class="var type1" id="S60T1U1589">rRxEval</span></span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line">                    <span class="mxinfo" id="T36:U1370"><span class="mxinfo" id="T36:U1371"><span class="var type1" id="S38T21U1593">EHK</span>(<span class="mxinfo" id="T1:U1373">8</span>,:)</span> = <span class="mxinfo" id="T36:U1374"><span class="mxinfo" id="T36:U1375"><span class="var type1" id="S38T21U1598">EHK</span>(<span class="mxinfo" id="T1:U1377">8</span>,:)</span>/<span class="var type1" id="S60T1U1601">rRxEval</span></span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line">                    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line">                    <span class="comment">% Multiply kernels by filter weights and sum them all up,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line">                    <span class="comment">% remembering to divide by the particular range:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line">                    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line">                    <span class="mxinfo" id="T19:U1379"><span class="mxinfo" id="T19:U1380"><span class="var type1" id="S2T21U1605">Er</span>(<span class="var type1" id="S59T1U1606">iRx</span>,<span class="var type1" id="S43T1U1607">iFreq</span>)</span> = <span class="mxinfo" id="T19:U1384">( <span class="mxinfo" id="T19:U1385"><span class="mxinfo" id="T19:U1386"><span class="mxinfo" id="T36:U1387"><span class="var type1" id="S38T21U1613">EHK</span>(<span class="mxinfo" id="T1:U1389">1</span>,:)</span>*<span class="mxinfo" id="T28:U1390"><span class="var type1" id="S21T27U1617">Filter</span>.J0</span></span> + <span class="mxinfo" id="T19:U1392"><span class="mxinfo" id="T36:U1393"><span class="var type1" id="S38T21U1621">EHK</span>(<span class="mxinfo" id="T1:U1395">2</span>,:)</span>*<span class="mxinfo" id="T28:U1396"><span class="var type1" id="S21T27U1625">Filter</span>.J1</span></span></span> )/<span class="var type1" id="S60T1U1627">rRxEval</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line">                    <span class="mxinfo" id="T19:U1399"><span class="mxinfo" id="T19:U1400"><span class="var type1" id="S3T21U1631">Eb</span>(<span class="var type1" id="S59T1U1632">iRx</span>,<span class="var type1" id="S43T1U1633">iFreq</span>)</span> = <span class="mxinfo" id="T19:U1404">( <span class="mxinfo" id="T19:U1405"><span class="mxinfo" id="T19:U1406"><span class="mxinfo" id="T36:U1407"><span class="var type1" id="S38T21U1639">EHK</span>(<span class="mxinfo" id="T1:U1409">3</span>,:)</span>*<span class="mxinfo" id="T28:U1410"><span class="var type1" id="S21T27U1643">Filter</span>.J0</span></span> + <span class="mxinfo" id="T19:U1412"><span class="mxinfo" id="T36:U1413"><span class="var type1" id="S38T21U1647">EHK</span>(<span class="mxinfo" id="T1:U1415">4</span>,:)</span>*<span class="mxinfo" id="T28:U1416"><span class="var type1" id="S21T27U1651">Filter</span>.J1</span></span></span> )/<span class="var type1" id="S60T1U1653">rRxEval</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line">                    <span class="mxinfo" id="T19:U1419"><span class="mxinfo" id="T19:U1420"><span class="var type1" id="S4T21U1657">Hr</span>(<span class="var type1" id="S59T1U1658">iRx</span>,<span class="var type1" id="S43T1U1659">iFreq</span>)</span> = <span class="mxinfo" id="T19:U1424">( <span class="mxinfo" id="T19:U1425"><span class="mxinfo" id="T19:U1426"><span class="mxinfo" id="T36:U1427"><span class="var type1" id="S38T21U1665">EHK</span>(<span class="mxinfo" id="T1:U1429">5</span>,:)</span>*<span class="mxinfo" id="T28:U1430"><span class="var type1" id="S21T27U1669">Filter</span>.J0</span></span> + <span class="mxinfo" id="T19:U1432"><span class="mxinfo" id="T36:U1433"><span class="var type1" id="S38T21U1673">EHK</span>(<span class="mxinfo" id="T1:U1435">6</span>,:)</span>*<span class="mxinfo" id="T28:U1436"><span class="var type1" id="S21T27U1677">Filter</span>.J1</span></span></span> )/<span class="var type1" id="S60T1U1679">rRxEval</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line">                    <span class="mxinfo" id="T19:U1439"><span class="mxinfo" id="T19:U1440"><span class="var type1" id="S5T21U1683">Hb</span>(<span class="var type1" id="S59T1U1684">iRx</span>,<span class="var type1" id="S43T1U1685">iFreq</span>)</span> = <span class="mxinfo" id="T19:U1444">( <span class="mxinfo" id="T19:U1445"><span class="mxinfo" id="T19:U1446"><span class="mxinfo" id="T36:U1447"><span class="var type1" id="S38T21U1691">EHK</span>(<span class="mxinfo" id="T1:U1449">7</span>,:)</span>*<span class="mxinfo" id="T28:U1450"><span class="var type1" id="S21T27U1695">Filter</span>.J0</span></span> + <span class="mxinfo" id="T19:U1452"><span class="mxinfo" id="T36:U1453"><span class="var type1" id="S38T21U1699">EHK</span>(<span class="mxinfo" id="T1:U1455">8</span>,:)</span>*<span class="mxinfo" id="T28:U1456"><span class="var type1" id="S21T27U1703">Filter</span>.J1</span></span></span> )/<span class="var type1" id="S60T1U1705">rRxEval</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line">                    <span class="mxinfo" id="T19:U1459"><span class="mxinfo" id="T19:U1460"><span class="var type1" id="S6T21U1709">Ez</span>(<span class="var type1" id="S59T1U1710">iRx</span>,<span class="var type1" id="S43T1U1711">iFreq</span>)</span> = <span class="mxinfo" id="T19:U1464">( <span class="mxinfo" id="T19:U1465"><span class="mxinfo" id="T36:U1466"><span class="var type1" id="S38T21U1716">EHK</span>(<span class="mxinfo" id="T1:U1468">9</span>,:)</span>*<span class="mxinfo" id="T28:U1469"><span class="var type1" id="S21T27U1720">Filter</span>.J1</span></span> )/<span class="var type1" id="S60T1U1722">rRxEval</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line">                    <span class="mxinfo" id="T19:U1472"><span class="mxinfo" id="T19:U1473"><span class="var type1" id="S7T21U1726">Hz</span>(<span class="var type1" id="S59T1U1727">iRx</span>,<span class="var type1" id="S43T1U1728">iFreq</span>)</span> = <span class="mxinfo" id="T19:U1477">( <span class="mxinfo" id="T19:U1478"><span class="mxinfo" id="T36:U1479"><span class="var type1" id="S38T21U1733">EHK</span>(<span class="mxinfo" id="T1:U1481">10</span>,:)</span>*<span class="mxinfo" id="T28:U1482"><span class="var type1" id="S21T27U1737">Filter</span>.J1</span></span> )/<span class="var type1" id="S60T1U1739">rRxEval</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line">                    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line">                    <span class="comment">% Update the stats structure:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line">                    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line">                    <span class="comment">%stats(iRx,iFreq).timer = toc(tstart);  % store the time for this eval</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line">                    <span class="comment">%stats(iRx,iFreq).fct   = length(lambda);        </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line">                <span class="keyword">end</span> <span class="comment">% loop over receivers</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line"><span class="comment">%         if all( abs(Er(:,iFreq)) &lt; 1d-20)  % we've hit the severe attenuation at high frequency</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line"><span class="comment">%             break; % no need to go to higher frequencies<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line"><span class="comment">%         end       </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line"><span class="comment">%  All done amigos, adios!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line">    <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line"></span></span>
</pre>

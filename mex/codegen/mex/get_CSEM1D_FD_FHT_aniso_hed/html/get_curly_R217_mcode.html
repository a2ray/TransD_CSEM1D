<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,369" id="srcline369">369</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,370" id="srcline370">370</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S127T19U2584">finRA</span>,<span class="var type1" id="S128T19U2585">finRD</span>] = get_curly_R(<span class="var type1" id="S129T19U2588">Rs_u</span>,<span class="var type1" id="S130T19U2589">Rs_d</span>,<span class="var type1" id="S131T19U2590">pz</span>,<span class="var type1" id="S132T1U2591">zR</span>,<span class="var type1" id="S133T3U2592">z</span>,<span class="var type1" id="S134T1U2593">iTxLayer</span>,<span class="var type1" id="S135T1U2594">omega</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,371" id="srcline371">371</a></span><span class="line">    <span class="comment">%global omega</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,372" id="srcline372">372</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,373" id="srcline373">373</a></span><span class="line"><span class="mxinfo" id="T1:U10"><span class="var type1" id="S136T1U2597">d</span>=<span class="mxinfo" id="T1:U12"><span class="mxinfo" id="T1:U13"><span class="var type1" id="S133T3U2600">z</span>(<span class="mxinfo" id="T1:U15"><span class="var type1" id="S134T1U2602">iTxLayer</span>+<span class="mxinfo" id="T1:U17">1</span></span>)</span>-<span class="mxinfo" id="T1:U18"><span class="var type1" id="S133T3U2605">z</span>(<span class="var type1" id="S134T1U2606">iTxLayer</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,374" id="srcline374">374</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo" id="T5:U21"><span class="var type1" id="S132T1U2611">zR</span>&gt;=<span class="mxinfo" id="T1:U23">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,375" id="srcline375">375</a></span><span class="line">        <span class="mxinfo" id="T19:U24"><span class="var type1" id="S127T19U2615">finRA</span> = <span class="mxinfo" id="T19:U26"><span class="mxinfo" id="T19:U27">(<span class="mxinfo" id="T19:U28"><span class="mxinfo" id="T1:U29">1</span> + <span class="mxinfo" id="T19:U30"><span class="mxinfo" id="T19:U31">exp(<span class="mxinfo" id="T19:U32"><span class="mxinfo" id="T19:U33"><span class="mxinfo" id="T19:U34"><span class="mxinfo" id="T19:U35"><span class="mxinfo" id="T19:U36">-1i</span>*<span class="var type1" id="S135T1U2630">omega</span></span>*<span class="var type1" id="S131T19U2631">pz</span></span>*<span class="mxinfo" id="T1:U39">2</span></span>*<span class="mxinfo" id="T1:U40"><span class="var type1" id="S133T3U2634">z</span>(<span class="var type1" id="S134T1U2635">iTxLayer</span>)</span></span>)</span>*<span class="var type1" id="S129T19U2636">Rs_u</span></span></span>)*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,376" id="srcline376">376</a></span><span class="line"><span class="mxinfo" id="T19:U24"><span class="mxinfo" id="T19:U26"><span class="mxinfo" id="T19:U27">                (<span class="mxinfo" id="T19:U44"><span class="mxinfo" id="T19:U45">exp(<span class="mxinfo" id="T19:U46"><span class="mxinfo" id="T19:U47"><span class="mxinfo" id="T19:U48"><span class="mxinfo" id="T19:U49">1i</span>*<span class="var type1" id="S135T1U2645">omega</span></span>*<span class="var type1" id="S131T19U2646">pz</span></span>*<span class="var type1" id="S132T1U2647">zR</span></span>)</span> + <span class="mxinfo" id="T19:U53"><span class="mxinfo" id="T19:U54">exp( <span class="mxinfo" id="T19:U55"><span class="mxinfo" id="T19:U56"><span class="mxinfo" id="T19:U57"><span class="mxinfo" id="T19:U58">1i</span>*<span class="var type1" id="S135T1U2655">omega</span></span>*<span class="var type1" id="S131T19U2656">pz</span></span>*(<span class="mxinfo" id="T1:U61"><span class="mxinfo" id="T1:U62"><span class="mxinfo" id="T1:U63">2</span>*<span class="mxinfo" id="T1:U64"><span class="var type1" id="S133T3U2662">z</span>(<span class="mxinfo" id="T1:U66"><span class="var type1" id="S134T1U2664">iTxLayer</span>+<span class="mxinfo" id="T1:U68">1</span></span>)</span></span> - <span class="var type1" id="S132T1U2666">zR</span></span>)</span>)</span>*<span class="var type1" id="S130T19U2667">Rs_d</span></span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,377" id="srcline377">377</a></span><span class="line"><span class="mxinfo" id="T19:U24"><span class="mxinfo" id="T19:U26">                (<span class="mxinfo" id="T19:U71"><span class="mxinfo" id="T1:U72">1</span> - <span class="mxinfo" id="T19:U73"><span class="mxinfo" id="T19:U74"><span class="var type1" id="S129T19U2673">Rs_u</span>*<span class="var type1" id="S130T19U2674">Rs_d</span></span>*<span class="mxinfo" id="T19:U77">exp(<span class="mxinfo" id="T19:U78"><span class="mxinfo" id="T19:U79"><span class="mxinfo" id="T19:U80"><span class="mxinfo" id="T19:U81">2i</span>*<span class="var type1" id="S135T1U2681">omega</span></span>*<span class="var type1" id="S131T19U2682">pz</span></span>*(<span class="var type1" id="S136T1U2684">d</span>)</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,378" id="srcline378">378</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,379" id="srcline379">379</a></span><span class="line">        <span class="mxinfo" id="T19:U85"><span class="var type1" id="S128T19U2687">finRD</span> = <span class="mxinfo" id="T19:U87"><span class="mxinfo" id="T19:U88">(<span class="mxinfo" id="T19:U89"><span class="mxinfo" id="T1:U90">1</span> - <span class="mxinfo" id="T19:U91"><span class="mxinfo" id="T19:U92">exp(<span class="mxinfo" id="T19:U93"><span class="mxinfo" id="T19:U94"><span class="mxinfo" id="T19:U95"><span class="mxinfo" id="T19:U96"><span class="mxinfo" id="T19:U97">-1i</span>*<span class="var type1" id="S135T1U2702">omega</span></span>*<span class="var type1" id="S131T19U2703">pz</span></span>*<span class="mxinfo" id="T1:U100">2</span></span>*<span class="mxinfo" id="T1:U101"><span class="var type1" id="S133T3U2706">z</span>(<span class="var type1" id="S134T1U2707">iTxLayer</span>)</span></span>)</span>*(<span class="mxinfo" id="T19:U104">-<span class="var type1" id="S129T19U2710">Rs_u</span></span>)</span></span>)*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,380" id="srcline380">380</a></span><span class="line"><span class="mxinfo" id="T19:U85"><span class="mxinfo" id="T19:U87"><span class="mxinfo" id="T19:U88">                    (<span class="mxinfo" id="T19:U106"><span class="mxinfo" id="T19:U107">exp(<span class="mxinfo" id="T19:U108"><span class="mxinfo" id="T19:U109"><span class="mxinfo" id="T19:U110"><span class="mxinfo" id="T19:U111">1i</span>*<span class="var type1" id="S135T1U2719">omega</span></span>*<span class="var type1" id="S131T19U2720">pz</span></span>*<span class="var type1" id="S132T1U2721">zR</span></span>)</span> + <span class="mxinfo" id="T19:U115"><span class="mxinfo" id="T19:U116">exp( <span class="mxinfo" id="T19:U117"><span class="mxinfo" id="T19:U118"><span class="mxinfo" id="T19:U119"><span class="mxinfo" id="T19:U120">1i</span>*<span class="var type1" id="S135T1U2729">omega</span></span>*<span class="var type1" id="S131T19U2730">pz</span></span>*(<span class="mxinfo" id="T1:U123"><span class="mxinfo" id="T1:U124"><span class="mxinfo" id="T1:U125">2</span>*<span class="mxinfo" id="T1:U126"><span class="var type1" id="S133T3U2736">z</span>(<span class="mxinfo" id="T1:U128"><span class="var type1" id="S134T1U2738">iTxLayer</span>+<span class="mxinfo" id="T1:U130">1</span></span>)</span></span> - <span class="var type1" id="S132T1U2740">zR</span></span>)</span>)</span>*(<span class="mxinfo" id="T19:U132">-<span class="var type1" id="S130T19U2743">Rs_d</span></span>)</span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,381" id="srcline381">381</a></span><span class="line"><span class="mxinfo" id="T19:U85"><span class="mxinfo" id="T19:U87">                    (<span class="mxinfo" id="T19:U134"><span class="mxinfo" id="T1:U135">1</span> - <span class="mxinfo" id="T19:U136"><span class="mxinfo" id="T19:U137"><span class="var type1" id="S129T19U2749">Rs_u</span>*<span class="var type1" id="S130T19U2750">Rs_d</span></span>*<span class="mxinfo" id="T19:U140">exp(<span class="mxinfo" id="T19:U141"><span class="mxinfo" id="T19:U142"><span class="mxinfo" id="T19:U143"><span class="mxinfo" id="T19:U144">2i</span>*<span class="var type1" id="S135T1U2757">omega</span></span>*<span class="var type1" id="S131T19U2758">pz</span></span>*(<span class="var type1" id="S136T1U2760">d</span>)</span>)</span></span></span>)</span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="1,382" id="srcline382">382</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,383" id="srcline383">383</a></span><span class="line">        <span class="mxinfo" id="T19:U148"><span class="var type1" id="S127T19U2764">finRA</span> = <span class="mxinfo" id="T19:U150"><span class="mxinfo" id="T19:U151">(<span class="mxinfo" id="T19:U152"><span class="mxinfo" id="T1:U153">1</span> + <span class="mxinfo" id="T19:U154"><span class="mxinfo" id="T19:U155">exp(<span class="mxinfo" id="T19:U156"><span class="mxinfo" id="T19:U157"><span class="mxinfo" id="T19:U158"><span class="mxinfo" id="T19:U159"><span class="mxinfo" id="T19:U160">1i</span>*<span class="var type1" id="S135T1U2778">omega</span></span>*<span class="var type1" id="S131T19U2779">pz</span></span>*<span class="mxinfo" id="T1:U163">2</span></span>*<span class="mxinfo" id="T1:U164"><span class="var type1" id="S133T3U2782">z</span>(<span class="mxinfo" id="T1:U166"><span class="var type1" id="S134T1U2784">iTxLayer</span>+<span class="mxinfo" id="T1:U168">1</span></span>)</span></span>)</span>*<span class="var type1" id="S130T19U2786">Rs_d</span></span></span>)*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,384" id="srcline384">384</a></span><span class="line"><span class="mxinfo" id="T19:U148"><span class="mxinfo" id="T19:U150"><span class="mxinfo" id="T19:U151">                (<span class="mxinfo" id="T19:U170"><span class="mxinfo" id="T19:U171">exp(<span class="mxinfo" id="T19:U172"><span class="mxinfo" id="T19:U173"><span class="mxinfo" id="T19:U174"><span class="mxinfo" id="T19:U175">-1i</span>*<span class="var type1" id="S135T1U2796">omega</span></span>*<span class="var type1" id="S131T19U2797">pz</span></span>*<span class="var type1" id="S132T1U2798">zR</span></span>)</span> + <span class="mxinfo" id="T19:U179"><span class="mxinfo" id="T19:U180">exp(<span class="mxinfo" id="T19:U181"><span class="mxinfo" id="T19:U182"><span class="mxinfo" id="T19:U183"><span class="mxinfo" id="T19:U184">-1i</span>*<span class="var type1" id="S135T1U2807">omega</span></span>*<span class="var type1" id="S131T19U2808">pz</span></span>*(<span class="mxinfo" id="T1:U187"><span class="mxinfo" id="T1:U188"><span class="mxinfo" id="T1:U189">2</span>*<span class="mxinfo" id="T1:U190"><span class="var type1" id="S133T3U2814">z</span>(<span class="var type1" id="S134T1U2815">iTxLayer</span>)</span></span> - <span class="var type1" id="S132T1U2816">zR</span></span>)</span>)</span>*<span class="var type1" id="S129T19U2817">Rs_u</span></span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,385" id="srcline385">385</a></span><span class="line"><span class="mxinfo" id="T19:U148"><span class="mxinfo" id="T19:U150">                (<span class="mxinfo" id="T19:U195"><span class="mxinfo" id="T1:U196">1</span> - <span class="mxinfo" id="T19:U197"><span class="mxinfo" id="T19:U198"><span class="var type1" id="S129T19U2823">Rs_u</span>*<span class="var type1" id="S130T19U2824">Rs_d</span></span>*<span class="mxinfo" id="T19:U201">exp(<span class="mxinfo" id="T19:U202"><span class="mxinfo" id="T19:U203"><span class="mxinfo" id="T19:U204"><span class="mxinfo" id="T19:U205">2i</span>*<span class="var type1" id="S135T1U2831">omega</span></span>*<span class="var type1" id="S131T19U2832">pz</span></span>*(<span class="var type1" id="S136T1U2834">d</span>)</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,386" id="srcline386">386</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,387" id="srcline387">387</a></span><span class="line">        <span class="mxinfo" id="T19:U209"><span class="var type1" id="S128T19U2837">finRD</span> = <span class="mxinfo" id="T19:U211"><span class="mxinfo" id="T19:U212">(<span class="mxinfo" id="T19:U213"><span class="mxinfo" id="T1:U214">-<span class="mxinfo" id="T1:U215">1</span></span> + <span class="mxinfo" id="T19:U216"><span class="mxinfo" id="T19:U217">exp(<span class="mxinfo" id="T19:U218"><span class="mxinfo" id="T19:U219"><span class="mxinfo" id="T19:U220"><span class="mxinfo" id="T19:U221"><span class="mxinfo" id="T19:U222">1i</span>*<span class="var type1" id="S135T1U2852">omega</span></span>*<span class="var type1" id="S131T19U2853">pz</span></span>*<span class="mxinfo" id="T1:U225">2</span></span>*<span class="mxinfo" id="T1:U226"><span class="var type1" id="S133T3U2856">z</span>(<span class="mxinfo" id="T1:U228"><span class="var type1" id="S134T1U2858">iTxLayer</span>+<span class="mxinfo" id="T1:U230">1</span></span>)</span></span>)</span>*(<span class="mxinfo" id="T19:U231">-<span class="var type1" id="S130T19U2862">Rs_d</span></span>)</span></span>)*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,388" id="srcline388">388</a></span><span class="line"><span class="mxinfo" id="T19:U209"><span class="mxinfo" id="T19:U211"><span class="mxinfo" id="T19:U212">                (<span class="mxinfo" id="T19:U233"><span class="mxinfo" id="T19:U234">exp(<span class="mxinfo" id="T19:U235"><span class="mxinfo" id="T19:U236"><span class="mxinfo" id="T19:U237"><span class="mxinfo" id="T19:U238">-1i</span>*<span class="var type1" id="S135T1U2872">omega</span></span>*<span class="var type1" id="S131T19U2873">pz</span></span>*<span class="var type1" id="S132T1U2874">zR</span></span>)</span> + <span class="mxinfo" id="T19:U242"><span class="mxinfo" id="T19:U243">exp(<span class="mxinfo" id="T19:U244"><span class="mxinfo" id="T19:U245"><span class="mxinfo" id="T19:U246"><span class="mxinfo" id="T19:U247">-1i</span>*<span class="var type1" id="S135T1U2883">omega</span></span>*<span class="var type1" id="S131T19U2884">pz</span></span>*(<span class="mxinfo" id="T1:U250"><span class="mxinfo" id="T1:U251"><span class="mxinfo" id="T1:U252">2</span>*<span class="mxinfo" id="T1:U253"><span class="var type1" id="S133T3U2890">z</span>(<span class="var type1" id="S134T1U2891">iTxLayer</span>)</span></span> - <span class="var type1" id="S132T1U2892">zR</span></span>)</span>)</span>*(<span class="mxinfo" id="T19:U257">-<span class="var type1" id="S129T19U2895">Rs_u</span></span>)</span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,389" id="srcline389">389</a></span><span class="line"><span class="mxinfo" id="T19:U209"><span class="mxinfo" id="T19:U211">                (<span class="mxinfo" id="T19:U259"><span class="mxinfo" id="T1:U260">1</span> - <span class="mxinfo" id="T19:U261"><span class="mxinfo" id="T19:U262"><span class="var type1" id="S129T19U2901">Rs_u</span>*<span class="var type1" id="S130T19U2902">Rs_d</span></span>*<span class="mxinfo" id="T19:U265">exp(<span class="mxinfo" id="T19:U266"><span class="mxinfo" id="T19:U267"><span class="mxinfo" id="T19:U268"><span class="mxinfo" id="T19:U269">2i</span>*<span class="var type1" id="S135T1U2909">omega</span></span>*<span class="var type1" id="S131T19U2910">pz</span></span>*(<span class="var type1" id="S136T1U2912">d</span>)</span>)</span></span></span>)</span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="1,390" id="srcline390">390</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,391" id="srcline391">391</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,392" id="srcline392">392</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,393" id="srcline393">393</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>

<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,328" id="srcline328">328</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,329" id="srcline329">329</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S144T19U2756">finRA</span>,<span class="var type1" id="S145T19U2757">finRD</span>,<span class="var type1" id="S146T19U2758">finRB</span>,<span class="var type1" id="S147T19U2759">finRC</span>] = get_curly_R(<span class="var type1" id="S148T19U2762">Rs_u</span>,<span class="var type1" id="S149T19U2763">Rs_d</span>,<span class="var type1" id="S150T19U2764">pz</span>,<span class="var type1" id="S151T1U2765">zR</span>,<span class="var type1" id="S152T3U2766">z</span>,<span class="var type1" id="S153T1U2767">iTxLayer</span>,<span class="var type1" id="S154T1U2768">omega</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,330" id="srcline330">330</a></span><span class="line">    <span class="comment">%global omega</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,331" id="srcline331">331</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,332" id="srcline332">332</a></span><span class="line"><span class="mxinfo" id="T1:U12"><span class="var type1" id="S155T1U2771">d</span>=<span class="mxinfo" id="T1:U14"><span class="mxinfo" id="T1:U15"><span class="var type1" id="S152T3U2774">z</span>(<span class="mxinfo" id="T1:U17"><span class="var type1" id="S153T1U2776">iTxLayer</span>+<span class="mxinfo" id="T1:U19">1</span></span>)</span>-<span class="mxinfo" id="T1:U20"><span class="var type1" id="S152T3U2779">z</span>(<span class="var type1" id="S153T1U2780">iTxLayer</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,333" id="srcline333">333</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo" id="T5:U23"><span class="var type1" id="S151T1U2785">zR</span>&gt;=<span class="mxinfo" id="T1:U25">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,334" id="srcline334">334</a></span><span class="line">        <span class="mxinfo" id="T19:U26"><span class="var type1" id="S144T19U2789">finRA</span> = <span class="mxinfo" id="T19:U28"><span class="mxinfo" id="T19:U29">(<span class="mxinfo" id="T19:U30"><span class="mxinfo" id="T1:U31">1</span> + <span class="mxinfo" id="T19:U32"><span class="mxinfo" id="T19:U33">exp(<span class="mxinfo" id="T19:U34"><span class="mxinfo" id="T19:U35"><span class="mxinfo" id="T19:U36"><span class="mxinfo" id="T19:U37"><span class="mxinfo" id="T19:U38">-1i</span>*<span class="var type1" id="S154T1U2804">omega</span></span>*<span class="var type1" id="S150T19U2805">pz</span></span>*<span class="mxinfo" id="T1:U41">2</span></span>*<span class="mxinfo" id="T1:U42"><span class="var type1" id="S152T3U2808">z</span>(<span class="var type1" id="S153T1U2809">iTxLayer</span>)</span></span>)</span>*<span class="var type1" id="S148T19U2810">Rs_u</span></span></span>)*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,335" id="srcline335">335</a></span><span class="line"><span class="mxinfo" id="T19:U26"><span class="mxinfo" id="T19:U28"><span class="mxinfo" id="T19:U29">                (<span class="mxinfo" id="T19:U46"><span class="mxinfo" id="T19:U47">exp(<span class="mxinfo" id="T19:U48"><span class="mxinfo" id="T19:U49"><span class="mxinfo" id="T19:U50"><span class="mxinfo" id="T19:U51">1i</span>*<span class="var type1" id="S154T1U2819">omega</span></span>*<span class="var type1" id="S150T19U2820">pz</span></span>*<span class="var type1" id="S151T1U2821">zR</span></span>)</span> + <span class="mxinfo" id="T19:U55"><span class="mxinfo" id="T19:U56">exp( <span class="mxinfo" id="T19:U57"><span class="mxinfo" id="T19:U58"><span class="mxinfo" id="T19:U59"><span class="mxinfo" id="T19:U60">1i</span>*<span class="var type1" id="S154T1U2829">omega</span></span>*<span class="var type1" id="S150T19U2830">pz</span></span>*(<span class="mxinfo" id="T1:U63"><span class="mxinfo" id="T1:U64"><span class="mxinfo" id="T1:U65">2</span>*<span class="mxinfo" id="T1:U66"><span class="var type1" id="S152T3U2836">z</span>(<span class="mxinfo" id="T1:U68"><span class="var type1" id="S153T1U2838">iTxLayer</span>+<span class="mxinfo" id="T1:U70">1</span></span>)</span></span> - <span class="var type1" id="S151T1U2840">zR</span></span>)</span>)</span>*<span class="var type1" id="S149T19U2841">Rs_d</span></span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,336" id="srcline336">336</a></span><span class="line"><span class="mxinfo" id="T19:U26"><span class="mxinfo" id="T19:U28">                (<span class="mxinfo" id="T19:U73"><span class="mxinfo" id="T1:U74">1</span> - <span class="mxinfo" id="T19:U75"><span class="mxinfo" id="T19:U76"><span class="var type1" id="S148T19U2847">Rs_u</span>*<span class="var type1" id="S149T19U2848">Rs_d</span></span>*<span class="mxinfo" id="T19:U79">exp(<span class="mxinfo" id="T19:U80"><span class="mxinfo" id="T19:U81"><span class="mxinfo" id="T19:U82"><span class="mxinfo" id="T19:U83">2i</span>*<span class="var type1" id="S154T1U2855">omega</span></span>*<span class="var type1" id="S150T19U2856">pz</span></span>*(<span class="var type1" id="S155T1U2858">d</span>)</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,337" id="srcline337">337</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,338" id="srcline338">338</a></span><span class="line">        <span class="mxinfo" id="T19:U87"><span class="var type1" id="S145T19U2861">finRD</span> = <span class="mxinfo" id="T19:U89"><span class="mxinfo" id="T19:U90">(<span class="mxinfo" id="T19:U91"><span class="mxinfo" id="T1:U92">1</span> - <span class="mxinfo" id="T19:U93"><span class="mxinfo" id="T19:U94">exp(<span class="mxinfo" id="T19:U95"><span class="mxinfo" id="T19:U96"><span class="mxinfo" id="T19:U97"><span class="mxinfo" id="T19:U98"><span class="mxinfo" id="T19:U99">-1i</span>*<span class="var type1" id="S154T1U2876">omega</span></span>*<span class="var type1" id="S150T19U2877">pz</span></span>*<span class="mxinfo" id="T1:U102">2</span></span>*<span class="mxinfo" id="T1:U103"><span class="var type1" id="S152T3U2880">z</span>(<span class="var type1" id="S153T1U2881">iTxLayer</span>)</span></span>)</span>*(<span class="mxinfo" id="T19:U106">-<span class="var type1" id="S148T19U2884">Rs_u</span></span>)</span></span>)*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,339" id="srcline339">339</a></span><span class="line"><span class="mxinfo" id="T19:U87"><span class="mxinfo" id="T19:U89"><span class="mxinfo" id="T19:U90">                    (<span class="mxinfo" id="T19:U108"><span class="mxinfo" id="T19:U109">exp(<span class="mxinfo" id="T19:U110"><span class="mxinfo" id="T19:U111"><span class="mxinfo" id="T19:U112"><span class="mxinfo" id="T19:U113">1i</span>*<span class="var type1" id="S154T1U2893">omega</span></span>*<span class="var type1" id="S150T19U2894">pz</span></span>*<span class="var type1" id="S151T1U2895">zR</span></span>)</span> + <span class="mxinfo" id="T19:U117"><span class="mxinfo" id="T19:U118">exp( <span class="mxinfo" id="T19:U119"><span class="mxinfo" id="T19:U120"><span class="mxinfo" id="T19:U121"><span class="mxinfo" id="T19:U122">1i</span>*<span class="var type1" id="S154T1U2903">omega</span></span>*<span class="var type1" id="S150T19U2904">pz</span></span>*(<span class="mxinfo" id="T1:U125"><span class="mxinfo" id="T1:U126"><span class="mxinfo" id="T1:U127">2</span>*<span class="mxinfo" id="T1:U128"><span class="var type1" id="S152T3U2910">z</span>(<span class="mxinfo" id="T1:U130"><span class="var type1" id="S153T1U2912">iTxLayer</span>+<span class="mxinfo" id="T1:U132">1</span></span>)</span></span> - <span class="var type1" id="S151T1U2914">zR</span></span>)</span>)</span>*(<span class="mxinfo" id="T19:U134">-<span class="var type1" id="S149T19U2917">Rs_d</span></span>)</span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,340" id="srcline340">340</a></span><span class="line"><span class="mxinfo" id="T19:U87"><span class="mxinfo" id="T19:U89">                    (<span class="mxinfo" id="T19:U136"><span class="mxinfo" id="T1:U137">1</span> - <span class="mxinfo" id="T19:U138"><span class="mxinfo" id="T19:U139"><span class="var type1" id="S148T19U2923">Rs_u</span>*<span class="var type1" id="S149T19U2924">Rs_d</span></span>*<span class="mxinfo" id="T19:U142">exp(<span class="mxinfo" id="T19:U143"><span class="mxinfo" id="T19:U144"><span class="mxinfo" id="T19:U145"><span class="mxinfo" id="T19:U146">2i</span>*<span class="var type1" id="S154T1U2931">omega</span></span>*<span class="var type1" id="S150T19U2932">pz</span></span>*(<span class="var type1" id="S155T1U2934">d</span>)</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,341" id="srcline341">341</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,342" id="srcline342">342</a></span><span class="line">        <span class="mxinfo" id="T19:U150"><span class="var type1" id="S146T19U2937">finRB</span> = <span class="mxinfo" id="T19:U152"><span class="mxinfo" id="T19:U153">(<span class="mxinfo" id="T19:U154"><span class="mxinfo" id="T1:U155">1</span> - <span class="mxinfo" id="T19:U156"><span class="mxinfo" id="T19:U157">exp(<span class="mxinfo" id="T19:U158"><span class="mxinfo" id="T19:U159"><span class="mxinfo" id="T19:U160"><span class="mxinfo" id="T19:U161"><span class="mxinfo" id="T19:U162">-1i</span>*<span class="var type1" id="S154T1U2952">omega</span></span>*<span class="var type1" id="S150T19U2953">pz</span></span>*<span class="mxinfo" id="T1:U165">2</span></span>*<span class="mxinfo" id="T1:U166"><span class="var type1" id="S152T3U2956">z</span>(<span class="var type1" id="S153T1U2957">iTxLayer</span>)</span></span>)</span>*<span class="var type1" id="S148T19U2958">Rs_u</span></span></span>)*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,343" id="srcline343">343</a></span><span class="line"><span class="mxinfo" id="T19:U150"><span class="mxinfo" id="T19:U152"><span class="mxinfo" id="T19:U153">                (<span class="mxinfo" id="T19:U170"><span class="mxinfo" id="T19:U171">exp(<span class="mxinfo" id="T19:U172"><span class="mxinfo" id="T19:U173"><span class="mxinfo" id="T19:U174"><span class="mxinfo" id="T19:U175">1i</span>*<span class="var type1" id="S154T1U2967">omega</span></span>*<span class="var type1" id="S150T19U2968">pz</span></span>*<span class="var type1" id="S151T1U2969">zR</span></span>)</span> + <span class="mxinfo" id="T19:U179"><span class="mxinfo" id="T19:U180">exp( <span class="mxinfo" id="T19:U181"><span class="mxinfo" id="T19:U182"><span class="mxinfo" id="T19:U183"><span class="mxinfo" id="T19:U184">1i</span>*<span class="var type1" id="S154T1U2977">omega</span></span>*<span class="var type1" id="S150T19U2978">pz</span></span>*(<span class="mxinfo" id="T1:U187"><span class="mxinfo" id="T1:U188"><span class="mxinfo" id="T1:U189">2</span>*<span class="mxinfo" id="T1:U190"><span class="var type1" id="S152T3U2984">z</span>(<span class="mxinfo" id="T1:U192"><span class="var type1" id="S153T1U2986">iTxLayer</span>+<span class="mxinfo" id="T1:U194">1</span></span>)</span></span> - <span class="var type1" id="S151T1U2988">zR</span></span>)</span>)</span>*<span class="var type1" id="S149T19U2989">Rs_d</span></span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,344" id="srcline344">344</a></span><span class="line"><span class="mxinfo" id="T19:U150"><span class="mxinfo" id="T19:U152">                (<span class="mxinfo" id="T19:U197"><span class="mxinfo" id="T1:U198">1</span> - <span class="mxinfo" id="T19:U199"><span class="mxinfo" id="T19:U200"><span class="var type1" id="S148T19U2995">Rs_u</span>*<span class="var type1" id="S149T19U2996">Rs_d</span></span>*<span class="mxinfo" id="T19:U203">exp(<span class="mxinfo" id="T19:U204"><span class="mxinfo" id="T19:U205"><span class="mxinfo" id="T19:U206"><span class="mxinfo" id="T19:U207">2i</span>*<span class="var type1" id="S154T1U3003">omega</span></span>*<span class="var type1" id="S150T19U3004">pz</span></span>*(<span class="var type1" id="S155T1U3006">d</span>)</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,345" id="srcline345">345</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,346" id="srcline346">346</a></span><span class="line">        <span class="mxinfo" id="T19:U211"><span class="var type1" id="S147T19U3009">finRC</span> = <span class="mxinfo" id="T19:U213"><span class="mxinfo" id="T19:U214">(<span class="mxinfo" id="T19:U215"><span class="mxinfo" id="T1:U216">1</span> + <span class="mxinfo" id="T19:U217"><span class="mxinfo" id="T19:U218">exp(<span class="mxinfo" id="T19:U219"><span class="mxinfo" id="T19:U220"><span class="mxinfo" id="T19:U221"><span class="mxinfo" id="T19:U222"><span class="mxinfo" id="T19:U223">-1i</span>*<span class="var type1" id="S154T1U3024">omega</span></span>*<span class="var type1" id="S150T19U3025">pz</span></span>*<span class="mxinfo" id="T1:U226">2</span></span>*<span class="mxinfo" id="T1:U227"><span class="var type1" id="S152T3U3028">z</span>(<span class="var type1" id="S153T1U3029">iTxLayer</span>)</span></span>)</span>*(<span class="mxinfo" id="T19:U230">-<span class="var type1" id="S148T19U3032">Rs_u</span></span>)</span></span>)*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,347" id="srcline347">347</a></span><span class="line"><span class="mxinfo" id="T19:U211"><span class="mxinfo" id="T19:U213"><span class="mxinfo" id="T19:U214">                    (<span class="mxinfo" id="T19:U232"><span class="mxinfo" id="T19:U233">exp(<span class="mxinfo" id="T19:U234"><span class="mxinfo" id="T19:U235"><span class="mxinfo" id="T19:U236"><span class="mxinfo" id="T19:U237">1i</span>*<span class="var type1" id="S154T1U3041">omega</span></span>*<span class="var type1" id="S150T19U3042">pz</span></span>*<span class="var type1" id="S151T1U3043">zR</span></span>)</span> + <span class="mxinfo" id="T19:U241"><span class="mxinfo" id="T19:U242">exp( <span class="mxinfo" id="T19:U243"><span class="mxinfo" id="T19:U244"><span class="mxinfo" id="T19:U245"><span class="mxinfo" id="T19:U246">1i</span>*<span class="var type1" id="S154T1U3051">omega</span></span>*<span class="var type1" id="S150T19U3052">pz</span></span>*(<span class="mxinfo" id="T1:U249"><span class="mxinfo" id="T1:U250"><span class="mxinfo" id="T1:U251">2</span>*<span class="mxinfo" id="T1:U252"><span class="var type1" id="S152T3U3058">z</span>(<span class="mxinfo" id="T1:U254"><span class="var type1" id="S153T1U3060">iTxLayer</span>+<span class="mxinfo" id="T1:U256">1</span></span>)</span></span> - <span class="var type1" id="S151T1U3062">zR</span></span>)</span>)</span>*(<span class="mxinfo" id="T19:U258">-<span class="var type1" id="S149T19U3065">Rs_d</span></span>)</span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,348" id="srcline348">348</a></span><span class="line"><span class="mxinfo" id="T19:U211"><span class="mxinfo" id="T19:U213">                    (<span class="mxinfo" id="T19:U260"><span class="mxinfo" id="T1:U261">1</span> - <span class="mxinfo" id="T19:U262"><span class="mxinfo" id="T19:U263"><span class="var type1" id="S148T19U3071">Rs_u</span>*<span class="var type1" id="S149T19U3072">Rs_d</span></span>*<span class="mxinfo" id="T19:U266">exp(<span class="mxinfo" id="T19:U267"><span class="mxinfo" id="T19:U268"><span class="mxinfo" id="T19:U269"><span class="mxinfo" id="T19:U270">2i</span>*<span class="var type1" id="S154T1U3079">omega</span></span>*<span class="var type1" id="S150T19U3080">pz</span></span>*(<span class="var type1" id="S155T1U3082">d</span>)</span>)</span></span></span>)</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="1,349" id="srcline349">349</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,350" id="srcline350">350</a></span><span class="line">        <span class="mxinfo" id="T19:U274"><span class="var type1" id="S144T19U3086">finRA</span> = <span class="mxinfo" id="T19:U276"><span class="mxinfo" id="T19:U277">(<span class="mxinfo" id="T19:U278"><span class="mxinfo" id="T1:U279">1</span> + <span class="mxinfo" id="T19:U280"><span class="mxinfo" id="T19:U281">exp(<span class="mxinfo" id="T19:U282"><span class="mxinfo" id="T19:U283"><span class="mxinfo" id="T19:U284"><span class="mxinfo" id="T19:U285"><span class="mxinfo" id="T19:U286">1i</span>*<span class="var type1" id="S154T1U3100">omega</span></span>*<span class="var type1" id="S150T19U3101">pz</span></span>*<span class="mxinfo" id="T1:U289">2</span></span>*<span class="mxinfo" id="T1:U290"><span class="var type1" id="S152T3U3104">z</span>(<span class="mxinfo" id="T1:U292"><span class="var type1" id="S153T1U3106">iTxLayer</span>+<span class="mxinfo" id="T1:U294">1</span></span>)</span></span>)</span>*<span class="var type1" id="S149T19U3108">Rs_d</span></span></span>)*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,351" id="srcline351">351</a></span><span class="line"><span class="mxinfo" id="T19:U274"><span class="mxinfo" id="T19:U276"><span class="mxinfo" id="T19:U277">                (<span class="mxinfo" id="T19:U296"><span class="mxinfo" id="T19:U297">exp(<span class="mxinfo" id="T19:U298"><span class="mxinfo" id="T19:U299"><span class="mxinfo" id="T19:U300"><span class="mxinfo" id="T19:U301">-1i</span>*<span class="var type1" id="S154T1U3118">omega</span></span>*<span class="var type1" id="S150T19U3119">pz</span></span>*<span class="var type1" id="S151T1U3120">zR</span></span>)</span> + <span class="mxinfo" id="T19:U305"><span class="mxinfo" id="T19:U306">exp(<span class="mxinfo" id="T19:U307"><span class="mxinfo" id="T19:U308"><span class="mxinfo" id="T19:U309"><span class="mxinfo" id="T19:U310">-1i</span>*<span class="var type1" id="S154T1U3129">omega</span></span>*<span class="var type1" id="S150T19U3130">pz</span></span>*(<span class="mxinfo" id="T1:U313"><span class="mxinfo" id="T1:U314"><span class="mxinfo" id="T1:U315">2</span>*<span class="mxinfo" id="T1:U316"><span class="var type1" id="S152T3U3136">z</span>(<span class="var type1" id="S153T1U3137">iTxLayer</span>)</span></span> - <span class="var type1" id="S151T1U3138">zR</span></span>)</span>)</span>*<span class="var type1" id="S148T19U3139">Rs_u</span></span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,352" id="srcline352">352</a></span><span class="line"><span class="mxinfo" id="T19:U274"><span class="mxinfo" id="T19:U276">                (<span class="mxinfo" id="T19:U321"><span class="mxinfo" id="T1:U322">1</span> - <span class="mxinfo" id="T19:U323"><span class="mxinfo" id="T19:U324"><span class="var type1" id="S148T19U3145">Rs_u</span>*<span class="var type1" id="S149T19U3146">Rs_d</span></span>*<span class="mxinfo" id="T19:U327">exp(<span class="mxinfo" id="T19:U328"><span class="mxinfo" id="T19:U329"><span class="mxinfo" id="T19:U330"><span class="mxinfo" id="T19:U331">2i</span>*<span class="var type1" id="S154T1U3153">omega</span></span>*<span class="var type1" id="S150T19U3154">pz</span></span>*(<span class="var type1" id="S155T1U3156">d</span>)</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,353" id="srcline353">353</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,354" id="srcline354">354</a></span><span class="line">        <span class="mxinfo" id="T19:U335"><span class="var type1" id="S145T19U3159">finRD</span> = <span class="mxinfo" id="T19:U337"><span class="mxinfo" id="T19:U338">(<span class="mxinfo" id="T19:U339"><span class="mxinfo" id="T1:U340">-<span class="mxinfo" id="T1:U341">1</span></span> + <span class="mxinfo" id="T19:U342"><span class="mxinfo" id="T19:U343">exp(<span class="mxinfo" id="T19:U344"><span class="mxinfo" id="T19:U345"><span class="mxinfo" id="T19:U346"><span class="mxinfo" id="T19:U347"><span class="mxinfo" id="T19:U348">1i</span>*<span class="var type1" id="S154T1U3174">omega</span></span>*<span class="var type1" id="S150T19U3175">pz</span></span>*<span class="mxinfo" id="T1:U351">2</span></span>*<span class="mxinfo" id="T1:U352"><span class="var type1" id="S152T3U3178">z</span>(<span class="mxinfo" id="T1:U354"><span class="var type1" id="S153T1U3180">iTxLayer</span>+<span class="mxinfo" id="T1:U356">1</span></span>)</span></span>)</span>*(<span class="mxinfo" id="T19:U357">-<span class="var type1" id="S149T19U3184">Rs_d</span></span>)</span></span>)*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,355" id="srcline355">355</a></span><span class="line"><span class="mxinfo" id="T19:U335"><span class="mxinfo" id="T19:U337"><span class="mxinfo" id="T19:U338">                (<span class="mxinfo" id="T19:U359"><span class="mxinfo" id="T19:U360">exp(<span class="mxinfo" id="T19:U361"><span class="mxinfo" id="T19:U362"><span class="mxinfo" id="T19:U363"><span class="mxinfo" id="T19:U364">-1i</span>*<span class="var type1" id="S154T1U3194">omega</span></span>*<span class="var type1" id="S150T19U3195">pz</span></span>*<span class="var type1" id="S151T1U3196">zR</span></span>)</span> + <span class="mxinfo" id="T19:U368"><span class="mxinfo" id="T19:U369">exp(<span class="mxinfo" id="T19:U370"><span class="mxinfo" id="T19:U371"><span class="mxinfo" id="T19:U372"><span class="mxinfo" id="T19:U373">-1i</span>*<span class="var type1" id="S154T1U3205">omega</span></span>*<span class="var type1" id="S150T19U3206">pz</span></span>*(<span class="mxinfo" id="T1:U376"><span class="mxinfo" id="T1:U377"><span class="mxinfo" id="T1:U378">2</span>*<span class="mxinfo" id="T1:U379"><span class="var type1" id="S152T3U3212">z</span>(<span class="var type1" id="S153T1U3213">iTxLayer</span>)</span></span> - <span class="var type1" id="S151T1U3214">zR</span></span>)</span>)</span>*(<span class="mxinfo" id="T19:U383">-<span class="var type1" id="S148T19U3217">Rs_u</span></span>)</span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,356" id="srcline356">356</a></span><span class="line"><span class="mxinfo" id="T19:U335"><span class="mxinfo" id="T19:U337">                (<span class="mxinfo" id="T19:U385"><span class="mxinfo" id="T1:U386">1</span> - <span class="mxinfo" id="T19:U387"><span class="mxinfo" id="T19:U388"><span class="var type1" id="S148T19U3223">Rs_u</span>*<span class="var type1" id="S149T19U3224">Rs_d</span></span>*<span class="mxinfo" id="T19:U391">exp(<span class="mxinfo" id="T19:U392"><span class="mxinfo" id="T19:U393"><span class="mxinfo" id="T19:U394"><span class="mxinfo" id="T19:U395">2i</span>*<span class="var type1" id="S154T1U3231">omega</span></span>*<span class="var type1" id="S150T19U3232">pz</span></span>*(<span class="var type1" id="S155T1U3234">d</span>)</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,357" id="srcline357">357</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,358" id="srcline358">358</a></span><span class="line">        <span class="mxinfo" id="T19:U399"><span class="var type1" id="S146T19U3237">finRB</span> = <span class="mxinfo" id="T19:U401"><span class="mxinfo" id="T19:U402">(<span class="mxinfo" id="T19:U403"><span class="mxinfo" id="T1:U404">-<span class="mxinfo" id="T1:U405">1</span></span> + <span class="mxinfo" id="T19:U406"><span class="mxinfo" id="T19:U407">exp(<span class="mxinfo" id="T19:U408"><span class="mxinfo" id="T19:U409"><span class="mxinfo" id="T19:U410"><span class="mxinfo" id="T19:U411"><span class="mxinfo" id="T19:U412">1i</span>*<span class="var type1" id="S154T1U3252">omega</span></span>*<span class="var type1" id="S150T19U3253">pz</span></span>*<span class="mxinfo" id="T1:U415">2</span></span>*<span class="mxinfo" id="T1:U416"><span class="var type1" id="S152T3U3256">z</span>(<span class="mxinfo" id="T1:U418"><span class="var type1" id="S153T1U3258">iTxLayer</span>+<span class="mxinfo" id="T1:U420">1</span></span>)</span></span>)</span>*<span class="var type1" id="S149T19U3260">Rs_d</span></span></span>)*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,359" id="srcline359">359</a></span><span class="line"><span class="mxinfo" id="T19:U399"><span class="mxinfo" id="T19:U401"><span class="mxinfo" id="T19:U402">                (<span class="mxinfo" id="T19:U422"><span class="mxinfo" id="T19:U423">exp(<span class="mxinfo" id="T19:U424"><span class="mxinfo" id="T19:U425"><span class="mxinfo" id="T19:U426"><span class="mxinfo" id="T19:U427">-1i</span>*<span class="var type1" id="S154T1U3270">omega</span></span>*<span class="var type1" id="S150T19U3271">pz</span></span>*<span class="var type1" id="S151T1U3272">zR</span></span>)</span> + <span class="mxinfo" id="T19:U431"><span class="mxinfo" id="T19:U432">exp(<span class="mxinfo" id="T19:U433"><span class="mxinfo" id="T19:U434"><span class="mxinfo" id="T19:U435"><span class="mxinfo" id="T19:U436">-1i</span>*<span class="var type1" id="S154T1U3281">omega</span></span>*<span class="var type1" id="S150T19U3282">pz</span></span>*(<span class="mxinfo" id="T1:U439"><span class="mxinfo" id="T1:U440"><span class="mxinfo" id="T1:U441">2</span>*<span class="mxinfo" id="T1:U442"><span class="var type1" id="S152T3U3288">z</span>(<span class="var type1" id="S153T1U3289">iTxLayer</span>)</span></span> - <span class="var type1" id="S151T1U3290">zR</span></span>)</span>)</span>*<span class="var type1" id="S148T19U3291">Rs_u</span></span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,360" id="srcline360">360</a></span><span class="line"><span class="mxinfo" id="T19:U399"><span class="mxinfo" id="T19:U401">                (<span class="mxinfo" id="T19:U447"><span class="mxinfo" id="T1:U448">1</span> - <span class="mxinfo" id="T19:U449"><span class="mxinfo" id="T19:U450"><span class="var type1" id="S148T19U3297">Rs_u</span>*<span class="var type1" id="S149T19U3298">Rs_d</span></span>*<span class="mxinfo" id="T19:U453">exp(<span class="mxinfo" id="T19:U454"><span class="mxinfo" id="T19:U455"><span class="mxinfo" id="T19:U456"><span class="mxinfo" id="T19:U457">2i</span>*<span class="var type1" id="S154T1U3305">omega</span></span>*<span class="var type1" id="S150T19U3306">pz</span></span>*(<span class="var type1" id="S155T1U3308">d</span>)</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,361" id="srcline361">361</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,362" id="srcline362">362</a></span><span class="line">        <span class="mxinfo" id="T19:U461"><span class="var type1" id="S147T19U3311">finRC</span> = <span class="mxinfo" id="T19:U463"><span class="mxinfo" id="T19:U464">(<span class="mxinfo" id="T19:U465"><span class="mxinfo" id="T1:U466">1</span> + <span class="mxinfo" id="T19:U467"><span class="mxinfo" id="T19:U468">exp(<span class="mxinfo" id="T19:U469"><span class="mxinfo" id="T19:U470"><span class="mxinfo" id="T19:U471"><span class="mxinfo" id="T19:U472"><span class="mxinfo" id="T19:U473">1i</span>*<span class="var type1" id="S154T1U3325">omega</span></span>*<span class="var type1" id="S150T19U3326">pz</span></span>*<span class="mxinfo" id="T1:U476">2</span></span>*<span class="mxinfo" id="T1:U477"><span class="var type1" id="S152T3U3329">z</span>(<span class="mxinfo" id="T1:U479"><span class="var type1" id="S153T1U3331">iTxLayer</span>+<span class="mxinfo" id="T1:U481">1</span></span>)</span></span>)</span>*(<span class="mxinfo" id="T19:U482">-<span class="var type1" id="S149T19U3335">Rs_d</span></span>)</span></span>)*<span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,363" id="srcline363">363</a></span><span class="line"><span class="mxinfo" id="T19:U461"><span class="mxinfo" id="T19:U463"><span class="mxinfo" id="T19:U464">                    (<span class="mxinfo" id="T19:U484"><span class="mxinfo" id="T19:U485">exp(<span class="mxinfo" id="T19:U486"><span class="mxinfo" id="T19:U487"><span class="mxinfo" id="T19:U488"><span class="mxinfo" id="T19:U489">-1i</span>*<span class="var type1" id="S154T1U3345">omega</span></span>*<span class="var type1" id="S150T19U3346">pz</span></span>*<span class="var type1" id="S151T1U3347">zR</span></span>)</span> + <span class="mxinfo" id="T19:U493"><span class="mxinfo" id="T19:U494">exp(<span class="mxinfo" id="T19:U495"><span class="mxinfo" id="T19:U496"><span class="mxinfo" id="T19:U497"><span class="mxinfo" id="T19:U498">-1i</span>*<span class="var type1" id="S154T1U3356">omega</span></span>*<span class="var type1" id="S150T19U3357">pz</span></span>*(<span class="mxinfo" id="T1:U501"><span class="mxinfo" id="T1:U502"><span class="mxinfo" id="T1:U503">2</span>*<span class="mxinfo" id="T1:U504"><span class="var type1" id="S152T3U3363">z</span>(<span class="var type1" id="S153T1U3364">iTxLayer</span>)</span></span> - <span class="var type1" id="S151T1U3365">zR</span></span>)</span>)</span>*(<span class="mxinfo" id="T19:U508">-<span class="var type1" id="S148T19U3368">Rs_u</span></span>)</span></span>)</span>/<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,364" id="srcline364">364</a></span><span class="line"><span class="mxinfo" id="T19:U461"><span class="mxinfo" id="T19:U463">                    (<span class="mxinfo" id="T19:U510"><span class="mxinfo" id="T1:U511">1</span> - <span class="mxinfo" id="T19:U512"><span class="mxinfo" id="T19:U513"><span class="var type1" id="S148T19U3374">Rs_u</span>*<span class="var type1" id="S149T19U3375">Rs_d</span></span>*<span class="mxinfo" id="T19:U516">exp(<span class="mxinfo" id="T19:U517"><span class="mxinfo" id="T19:U518"><span class="mxinfo" id="T19:U519"><span class="mxinfo" id="T19:U520">2i</span>*<span class="var type1" id="S154T1U3382">omega</span></span>*<span class="var type1" id="S150T19U3383">pz</span></span>*(<span class="var type1" id="S155T1U3385">d</span>)</span>)</span></span></span>)</span></span>;        </span></span>
<span class="srcline"><span class="lineno"><a href="1,365" id="srcline365">365</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,366" id="srcline366">366</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,367" id="srcline367">367</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,368" id="srcline368">368</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
